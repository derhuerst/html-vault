<!DOCTYPE HTML>

<html>
<head>
	<meta charset="utf-8">
	<title>html-vault</title>
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta name="description" content="Store a secret securely in a file.">
	<meta name="keywords" content="secret, encrypt, decrypt, aes, html, share">
	<meta name="author" content="Jannis R">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<style>
body {
	margin: 0 auto; padding: 0 1em; max-width: 28em;
	font-size: 110%; font-family: "Helvetica Neue", sans-serif;
}
p { color: #333; line-height: 1.3; }
a { color: #2980b9; text-decoration: none; }
input, button, textarea {
	display: block; margin: 1em 0; box-sizing: border-box; width: 100%;
	font-size: 100%;
}
input, textarea { padding: .4em; border: 1px solid #888; border-radius: .2em; }
input.error, textarea.error { border-color: #c0392b; }
button {
	padding: .4em;
	border: none; border-radius: .2em;
	color: white; background-color: #2980b9;
	cursor: pointer;
}
button:active { background-color: #1970a9; }
button.error { background-color: #c0392b; }
textarea { min-height: 7em; font-family: "Helvetica Neue", sans-serif; }

#hint {
	display: none;
	padding: .4em .5em; border-radius: .2em;
	color: white; background-color: #c0392b;
}
#notes { margin-top: 3em; color: #555; font-size: 90%; }
#notes::before { content: "*"; padding-right: .3em; }

#github { margin-top: 3em; text-align: center; }
#github path { fill: #aaa; }
	</style>
</head>
<body>
	<p>Using this service, you can generate a file that contains a secret. The secret can only be obtained using the password that you provided.</p>
	<p id="hint"></p>
	<textarea id="message" placeholder="Enter your secret message." name="message"></textarea>
	<input type="password" id="password" placeholder="Pick a password that is long and hard-to-guess."/>
	<p>Once you have saved the file, send it using whatever tool you want. Remember to transmit the password separately.<a href="#notes">*</a></p>
	<button id="submit">Encrypt my secret</button>
	<p id="notes">The encryption is only as secure as the weakest link in the chain. Don't send the file and password over the same channel. If you're serious about security, don't send the password at all, but give it to the receiver manually.</p>
	<!-- https://github.com/github/octicons/blob/0640e0c0e555a02e4628b96d5e72ef3328f27214/svg/mark-github.svg -->
	<p id="github"><a href="https://github.com/derhuerst/html-vault"><svg height="32" width="32" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59 0.4 0.07 0.55-0.17 0.55-0.38 0-0.19-0.01-0.82-0.01-1.49-2.01 0.37-2.53-0.49-2.69-0.94-0.09-0.23-0.48-0.94-0.82-1.13-0.28-0.15-0.68-0.52-0.01-0.53 0.63-0.01 1.08 0.58 1.23 0.82 0.72 1.21 1.87 0.87 2.33 0.66 0.07-0.52 0.28-0.87 0.51-1.07-1.78-0.2-3.64-0.89-3.64-3.95 0-0.87 0.31-1.59 0.82-2.15-0.08-0.2-0.36-1.02 0.08-2.12 0 0 0.67-0.21 2.2 0.82 0.64-0.18 1.32-0.27 2-0.27 0.68 0 1.36 0.09 2 0.27 1.53-1.04 2.2-0.82 2.2-0.82 0.44 1.1 0.16 1.92 0.08 2.12 0.51 0.56 0.82 1.27 0.82 2.15 0 3.07-1.87 3.75-3.65 3.95 0.29 0.25 0.54 0.73 0.54 1.48 0 1.07-0.01 1.93-0.01 2.2 0 0.21 0.15 0.46 0.55 0.38C13.71 14.53 16 11.53 16 8 16 3.58 12.42 0 8 0z"/></svg></a></p>
	<script>//download.js v4.1, by dandavis; 2008-2015. [CCBY2] see http://danml.com/download.html for tests/usage
(function(q,k){"function"==typeof define&&define.amd?define([],k):"object"==typeof exports?module.exports=k():q.download=k()})(this,function(){return function k(b,c,e){function r(n){var a=n.split(/[:;,]/);n=a[1];var a=("base64"==a[2]?atob:decodeURIComponent)(a.pop()),b=a.length,d=0,c=new Uint8Array(b);for(d;d<b;++d)c[d]=a.charCodeAt(d);return new g([c],{type:n})}function l(a,b){if("download"in d)return d.href=a,d.setAttribute("download",m),d.className="download-js-link",d.innerHTML="downloading...",h.body.appendChild(d),setTimeout(function(){d.click(),h.body.removeChild(d),!0===b&&setTimeout(function(){f.URL.revokeObjectURL(d.href)},250)},66),!0;if("undefined"!=typeof safari)return a="data:"+a.replace(/^data:([\w\/\-\+]+)/,"application/octet-stream"),!window.open(a)&&confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=a),!0;var c=h.createElement("iframe");h.body.appendChild(c),b||(a="data:"+a.replace(/^data:([\w\/\-\+]+)/,"application/octet-stream")),c.src=a,setTimeout(function(){h.body.removeChild(c)},333)}var f=window,a=e||"application/octet-stream";e=!c&&!e&&b;var h=document,d=h.createElement("a"),p=function(a){return String(a)},g=f.Blob||f.MozBlob||f.WebKitBlob||p,m=c||"download",g=g.call?g.bind(f):Blob;"true"===String(this)&&(b=[b,a],a=b[0],b=b[1]);if(e&&2048>e.length&&(m=e.split("/").pop().split("?")[0],d.href=e,-1!==d.href.indexOf(e)))return a=new XMLHttpRequest,a.open("GET",e,!0),a.responseType="blob",a.onload=function(a){k(a.target.response,m,"application/octet-stream")},a.send(),a;if(/^data\:[\w+\-]+\/[\w+\-]+[,;]/.test(b))return navigator.msSaveBlob?navigator.msSaveBlob(r(b),m):l(b);c=b instanceof g?b:new g([b],{type:a});if(navigator.msSaveBlob)return navigator.msSaveBlob(c,m);if(f.URL)l(f.URL.createObjectURL(c),!0);else{if("string"==typeof c||c.constructor===p)try{return l("data:"+a+";base64,"+f.btoa(c))}catch(n){return l("data:"+a+","+encodeURIComponent(c))}a=new FileReader,a.onload=function(a){l(this.result)},a.readAsDataURL(c)}return!0}});
</script>
	<script>"use strict";function q(a){throw a;}var s=void 0,u=!1;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};
"undefined"!==typeof module&&module.exports&&(module.exports=sjcl);"function"===typeof define&&define([],function(){return sjcl});
sjcl.cipher.aes=function(a){this.k[0][0][0]||this.D();var b,c,d,e,f=this.k[0][4],g=this.k[1];b=a.length;var h=1;4!==b&&(6!==b&&8!==b)&&q(new sjcl.exception.invalid("invalid aes key size"));this.b=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d[a]=d[a-b]^c}for(b=0;a;b++,a--)c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&
255]]};
sjcl.cipher.aes.prototype={encrypt:function(a){return w(this,a,0)},decrypt:function(a){return w(this,a,1)},k:[[[],[],[],[],[]],[[],[],[],[],[]]],D:function(){var a=this.k[0],b=this.k[1],c=a[4],d=b[4],e,f,g,h=[],l=[],k,n,m,p;for(e=0;0x100>e;e++)l[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=k||1,g=l[g]||1){m=g^g<<1^g<<2^g<<3^g<<4;m=m>>8^m&255^99;c[f]=m;d[m]=f;n=h[e=h[k=h[f]]];p=0x1010101*n^0x10001*e^0x101*k^0x1010100*f;n=0x101*h[m]^0x1010100*m;for(e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p=p<<24^p>>>8}for(e=
0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};
function w(a,b,c){4!==b.length&&q(new sjcl.exception.invalid("invalid aes block size"));var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,l,k,n=d.length/4-2,m,p=4,t=[0,0,0,0];h=a.k[c];a=h[0];var r=h[1],v=h[2],y=h[3],z=h[4];for(m=0;m<n;m++)h=a[e>>>24]^r[f>>16&255]^v[g>>8&255]^y[b&255]^d[p],l=a[f>>>24]^r[g>>16&255]^v[b>>8&255]^y[e&255]^d[p+1],k=a[g>>>24]^r[b>>16&255]^v[e>>8&255]^y[f&255]^d[p+2],b=a[b>>>24]^r[e>>16&255]^v[f>>8&255]^y[g&255]^d[p+3],p+=4,e=h,f=l,g=k;for(m=0;4>
m;m++)t[c?3&-m:m]=z[e>>>24]<<24^z[f>>16&255]<<16^z[g>>8&255]<<8^z[b&255]^d[p++],h=e,e=f,f=g,g=b,b=h;return t}
sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.P(a.slice(b/32),32-(b&31)).slice(1);return c===s?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.P(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===
b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b&=31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+0x10000000000*a},getPartial:function(a){return Math.round(a/0x10000000000)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return u;var c=0,d;for(d=0;d<a.length;d++)c|=a[d]^b[d];return 0===
c},P:function(a,b,c,d){var e;e=0;for(d===s&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d},l:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&0xff00|(c&0xff00)<<8|c<<24;return a}};
sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++)0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>24),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++)d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};
sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d;a=a.replace(/\s|0x/g,"");d=a.length;a+="00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,4*d)}};
sjcl.codec.base64={J:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.J,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d.length&3&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\s|=/g,"");var c=[],d,e=0,f=sjcl.codec.base64.J,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d=0;d<a.length;d++)h=f.indexOf(a.charAt(d)),
0>h&&q(new sjcl.exception.invalid("this isn't base64!")),26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e);e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.hash.sha256=function(a){this.b[0]||this.D();a?(this.r=a.r.slice(0),this.o=a.o.slice(0),this.h=a.h):this.reset()};sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256).update(a).finalize()};
sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.r=this.N.slice(0);this.o=[];this.h=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.o=sjcl.bitArray.concat(this.o,a);b=this.h;a=this.h=b+sjcl.bitArray.bitLength(a);for(b=512+b&-512;b<=a;b+=512)x(this,c.splice(0,16));return this},finalize:function(){var a,b=this.o,c=this.r,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.h/
4294967296));for(b.push(this.h|0);b.length;)x(this,b.splice(0,16));this.reset();return c},N:[],b:[],D:function(){function a(a){return 0x100000000*(a-Math.floor(a))|0}var b=0,c=2,d;a:for(;64>b;c++){for(d=2;d*d<=c;d++)if(0===c%d)continue a;8>b&&(this.N[b]=a(Math.pow(c,0.5)));this.b[b]=a(Math.pow(c,1/3));b++}}};
function x(a,b){var c,d,e,f=b.slice(0),g=a.r,h=a.b,l=g[0],k=g[1],n=g[2],m=g[3],p=g[4],t=g[5],r=g[6],v=g[7];for(c=0;64>c;c++)16>c?d=f[c]:(d=f[c+1&15],e=f[c+14&15],d=f[c&15]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+f[c&15]+f[c+9&15]|0),d=d+v+(p>>>6^p>>>11^p>>>25^p<<26^p<<21^p<<7)+(r^p&(t^r))+h[c],v=r,r=t,t=p,p=m+d|0,m=n,n=k,k=l,l=d+(k&n^m&(k^n))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;g[0]=g[0]+l|0;g[1]=g[1]+k|0;g[2]=g[2]+n|0;g[3]=g[3]+m|0;g[4]=g[4]+p|0;g[5]=g[5]+t|0;g[6]=
g[6]+r|0;g[7]=g[7]+v|0}
sjcl.mode.ccm={name:"ccm",encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,l=h.bitLength(c)/8,k=h.bitLength(g)/8;e=e||64;d=d||[];7>l&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes"));for(f=2;4>f&&k>>>8*f;f++);f<15-l&&(f=15-l);c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.L(a,b,c,d,e,f);g=sjcl.mode.ccm.p(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),l=f.clamp(b,h-e),k=f.bitSlice(b,
h-e),h=(h-e)/8;7>g&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes"));for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));l=sjcl.mode.ccm.p(a,l,c,k,e,b);a=sjcl.mode.ccm.L(a,l.data,c,d,e,b);f.equal(l.tag,a)||q(new sjcl.exception.corrupt("ccm: tag doesn't match"));return l.data},L:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,l=h.l;e/=8;(e%2||4>e||16<e)&&q(new sjcl.exception.invalid("ccm: invalid tag length"));(0xffffffff<d.length||0xffffffff<b.length)&&q(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data"));
f=[h.partial(8,(d.length?64:0)|e-2<<2|f-1)];f=h.concat(f,c);f[3]|=h.bitLength(b)/8;f=a.encrypt(f);if(d.length){c=h.bitLength(d)/8;65279>=c?g=[h.partial(16,c)]:0xffffffff>=c&&(g=h.concat([h.partial(16,65534)],[c]));g=h.concat(g,d);for(d=0;d<g.length;d+=4)f=a.encrypt(l(f,g.slice(d,d+4).concat([0,0,0])))}for(d=0;d<b.length;d+=4)f=a.encrypt(l(f,b.slice(d,d+4).concat([0,0,0])));return h.clamp(f,8*e)},p:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.l;var l=b.length,k=h.bitLength(b);c=h.concat([h.partial(8,
f-1)],c).concat([0,0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!l)return{tag:d,data:[]};for(g=0;g<l;g+=4)c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d,data:h.clamp(b,k)}}};
sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){128!==sjcl.bitArray.bitLength(c)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));var g,h=sjcl.mode.ocb2.H,l=sjcl.bitArray,k=l.l,n=[0,0,0,0];c=h(a.encrypt(c));var m,p=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=k(n,m),p=p.concat(k(c,a.encrypt(k(c,m)))),c=h(c);m=b.slice(g);b=l.bitLength(m);g=a.encrypt(k(c,[0,0,0,b]));m=l.clamp(k(m.concat([0,0,0]),g),b);n=k(n,k(m.concat([0,0,0]),g));n=a.encrypt(k(n,k(c,h(c))));d.length&&
(n=k(n,f?d:sjcl.mode.ocb2.pmac(a,d)));return p.concat(l.concat(m,l.clamp(n,e)))},decrypt:function(a,b,c,d,e,f){128!==sjcl.bitArray.bitLength(c)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));e=e||64;var g=sjcl.mode.ocb2.H,h=sjcl.bitArray,l=h.l,k=[0,0,0,0],n=g(a.encrypt(c)),m,p,t=sjcl.bitArray.bitLength(b)-e,r=[];d=d||[];for(c=0;c+4<t/32;c+=4)m=l(n,a.decrypt(l(n,b.slice(c,c+4)))),k=l(k,m),r=r.concat(m),n=g(n);p=t-32*c;m=a.encrypt(l(n,[0,0,0,p]));m=l(m,h.clamp(b.slice(c),p).concat([0,0,0]));
k=l(k,m);k=a.encrypt(l(k,l(n,g(n))));d.length&&(k=l(k,f?d:sjcl.mode.ocb2.pmac(a,d)));h.equal(h.clamp(k,e),h.bitSlice(b,t))||q(new sjcl.exception.corrupt("ocb: tag doesn't match"));return r.concat(h.clamp(m,p))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.H,e=sjcl.bitArray,f=e.l,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d(f(h,
d(h))),g))},H:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};
sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);b=sjcl.bitArray;d=d||[];a=sjcl.mode.gcm.p(!0,a,f,d,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d=d||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.p(u,a,f,d,c,e);g.equal(a.tag,b)||q(new sjcl.exception.corrupt("gcm: tag doesn't match"));return a.data},Z:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.l;e=[0,0,0,0];f=b.slice(0);
for(c=0;128>c;c++){(d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d=3;0<d;d--)f[d]=f[d]>>>1|(f[d-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-0x1f000000)}return e},g:function(a,b,c){var d,e=c.length;b=b.slice(0);for(d=0;d<e;d+=4)b[0]^=0xffffffff&c[d],b[1]^=0xffffffff&c[d+1],b[2]^=0xffffffff&c[d+2],b[3]^=0xffffffff&c[d+3],b=sjcl.mode.gcm.Z(b,a);return b},p:function(a,b,c,d,e,f){var g,h,l,k,n,m,p,t,r=sjcl.bitArray;m=c.length;p=r.bitLength(c);t=r.bitLength(d);h=r.bitLength(e);g=b.encrypt([0,
0,0,0]);96===h?(e=e.slice(0),e=r.concat(e,[1])):(e=sjcl.mode.gcm.g(g,[0,0,0,0],e),e=sjcl.mode.gcm.g(g,e,[0,0,Math.floor(h/0x100000000),h&0xffffffff]));h=sjcl.mode.gcm.g(g,[0,0,0,0],d);n=e.slice(0);d=h.slice(0);a||(d=sjcl.mode.gcm.g(g,h,c));for(k=0;k<m;k+=4)n[3]++,l=b.encrypt(n),c[k]^=l[0],c[k+1]^=l[1],c[k+2]^=l[2],c[k+3]^=l[3];c=r.clamp(c,p);a&&(d=sjcl.mode.gcm.g(g,h,c));a=[Math.floor(t/0x100000000),t&0xffffffff,Math.floor(p/0x100000000),p&0xffffffff];d=sjcl.mode.gcm.g(g,d,a);l=b.encrypt(e);d[0]^=l[0];
d[1]^=l[1];d[2]^=l[2];d[3]^=l[3];return{tag:r.bitSlice(d,0,f),data:c}}};sjcl.misc.hmac=function(a,b){this.M=b=b||sjcl.hash.sha256;var c=[[],[]],d,e=b.prototype.blockSize/32;this.n=[new b,new b];a.length>e&&(a=b.hash(a));for(d=0;d<e;d++)c[0][d]=a[d]^909522486,c[1][d]=a[d]^1549556828;this.n[0].update(c[0]);this.n[1].update(c[1]);this.G=new b(this.n[0])};
sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){this.Q&&q(new sjcl.exception.invalid("encrypt on already updated hmac called!"));this.update(a);return this.digest(a)};sjcl.misc.hmac.prototype.reset=function(){this.G=new this.M(this.n[0]);this.Q=u};sjcl.misc.hmac.prototype.update=function(a){this.Q=!0;this.G.update(a)};sjcl.misc.hmac.prototype.digest=function(){var a=this.G.finalize(),a=(new this.M(this.n[1])).update(a).finalize();this.reset();return a};
sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1E3;(0>d||0>c)&&q(sjcl.exception.invalid("invalid params to pbkdf2"));"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,l,k=[],n=sjcl.bitArray;for(l=1;32*k.length<(d||1);l++){e=f=a.encrypt(n.concat(b,[l]));for(g=1;g<c;g++){f=a.encrypt(f);for(h=0;h<f.length;h++)e[h]^=f[h]}k=k.concat(e)}d&&(k=n.clamp(k,d));return k};
sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.i=[0];this.F=0;this.s={};this.C=0;this.K={};this.O=this.d=this.j=this.W=0;this.b=[0,0,0,0,0,0,0,0];this.f=[0,0,0,0];this.A=s;this.B=a;this.q=u;this.w={progress:{},seeded:{}};this.m=this.V=0;this.t=1;this.u=2;this.S=0x10000;this.I=[0,48,64,96,128,192,0x100,384,512,768,1024];this.T=3E4;this.R=80};
sjcl.prng.prototype={randomWords:function(a,b){var c=[],d;d=this.isReady(b);var e;d===this.m&&q(new sjcl.exception.notReady("generator isn't seeded"));if(d&this.u){d=!(d&this.t);e=[];var f=0,g;this.O=e[0]=(new Date).valueOf()+this.T;for(g=0;16>g;g++)e.push(0x100000000*Math.random()|0);for(g=0;g<this.c.length&&!(e=e.concat(this.c[g].finalize()),f+=this.i[g],this.i[g]=0,!d&&this.F&1<<g);g++);this.F>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.i.push(0));this.d-=f;f>this.j&&(this.j=f);this.F++;
this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.A=new sjcl.cipher.aes(this.b);for(d=0;4>d&&!(this.f[d]=this.f[d]+1|0,this.f[d]);d++);}for(d=0;d<a;d+=4)0===(d+1)%this.S&&A(this),e=B(this),c.push(e[0],e[1],e[2],e[3]);A(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b&&q("Setting paranoia=0 will ruin your security; use it only for testing");this.B=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=(new Date).valueOf(),
g=this.s[c],h=this.isReady(),l=0;d=this.K[c];d===s&&(d=this.K[c]=this.W++);g===s&&(g=this.s[c]=0);this.s[c]=(this.s[c]+1)%this.c.length;switch(typeof a){case "number":b===s&&(b=1);this.c[g].update([d,this.C++,1,b,f,1,a|0]);break;case "object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else{"[object Array]"!==c&&(l=1);for(c=0;c<a.length&&!l;c++)"number"!==typeof a[c]&&(l=1)}if(!l){if(b===s)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,
e>>>=1;this.c[g].update([d,this.C++,2,b,f,a.length].concat(a))}break;case "string":b===s&&(b=a.length);this.c[g].update([d,this.C++,3,b,f,a.length]);this.c[g].update(a);break;default:l=1}l&&q(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string"));this.i[g]+=b;this.d+=b;h===this.m&&(this.isReady()!==this.m&&C("seeded",Math.max(this.j,this.d)),C("progress",this.getProgress()))},isReady:function(a){a=this.I[a!==s?a:this.B];return this.j&&this.j>=a?this.i[0]>this.R&&
(new Date).valueOf()>this.O?this.u|this.t:this.t:this.d>=a?this.u|this.m:this.m},getProgress:function(a){a=this.I[a?a:this.B];return this.j>=a?1:this.d>a?1:this.d/a},startCollectors:function(){this.q||(this.a={loadTimeCollector:D(this,this.aa),mouseCollector:D(this,this.ba),keyboardCollector:D(this,this.$),accelerometerCollector:D(this,this.U),touchCollector:D(this,this.da)},window.addEventListener?(window.addEventListener("load",this.a.loadTimeCollector,u),window.addEventListener("mousemove",this.a.mouseCollector,
u),window.addEventListener("keypress",this.a.keyboardCollector,u),window.addEventListener("devicemotion",this.a.accelerometerCollector,u),window.addEventListener("touchmove",this.a.touchCollector,u)):document.attachEvent?(document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)):q(new sjcl.exception.bug("can't attach event")),this.q=!0)},stopCollectors:function(){this.q&&(window.removeEventListener?
(window.removeEventListener("load",this.a.loadTimeCollector,u),window.removeEventListener("mousemove",this.a.mouseCollector,u),window.removeEventListener("keypress",this.a.keyboardCollector,u),window.removeEventListener("devicemotion",this.a.accelerometerCollector,u),window.removeEventListener("touchmove",this.a.touchCollector,u)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",
this.a.keyboardCollector)),this.q=u)},addEventListener:function(a,b){this.w[a][this.V++]=b},removeEventListener:function(a,b){var c,d,e=this.w[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},$:function(){E(1)},ba:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d){c=b=0}0!=b&&0!=c&&sjcl.random.addEntropy([b,c],2,"mouse");E(0)},da:function(a){a=a.touches[0]||a.changedTouches[0];sjcl.random.addEntropy([a.pageX||
a.clientX,a.pageY||a.clientY],1,"touch");E(0)},aa:function(){E(2)},U:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&sjcl.random.addEntropy(b,1,"accelerometer")}a&&sjcl.random.addEntropy(a,2,"accelerometer");E(0)}};function C(a,b){var c,d=sjcl.random.w[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}
function E(a){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?sjcl.random.addEntropy(window.performance.now(),a,"loadtime"):sjcl.random.addEntropy((new Date).valueOf(),a,"loadtime")}function A(a){a.b=B(a).concat(B(a));a.A=new sjcl.cipher.aes(a.b)}function B(a){for(var b=0;4>b&&!(a.f[b]=a.f[b]+1|0,a.f[b]);b++);return a.A.encrypt(a.f)}function D(a,b){return function(){b.apply(a,arguments)}}sjcl.random=new sjcl.prng(6);
a:try{var F,G,H,I;if(I="undefined"!==typeof module){var J;if(J=module.exports){var K;try{K=require("crypto")}catch(L){K=null}J=(G=K)&&G.randomBytes}I=J}if(I)F=G.randomBytes(128),F=new Uint32Array((new Uint8Array(F)).buffer),sjcl.random.addEntropy(F,1024,"crypto['randomBytes']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){H=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(H);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(H);
else break a;sjcl.random.addEntropy(H,1024,"crypto['getRandomValues']")}}catch(M){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(M))}
sjcl.json={defaults:{v:1,iter:1E3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},Y:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.e({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.e(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&0x100!==f.ks||2>f.iv.length||4<
f.iv.length)&&q(new sjcl.exception.invalid("json encrypt: invalid parameters"));"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.e(d,f);d.key=a;f.ct=sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},
encrypt:function(a,b,c,d){var e=sjcl.json,f=e.Y.apply(e,arguments);return e.encode(f)},X:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.e(e.e(e.e({},e.defaults),b),c,!0);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&0x100!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)&&
q(new sjcl.exception.invalid("json decrypt: invalid parameters"));"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl.codec.utf8String.toBits(f));g=new sjcl.cipher[b.cipher](a);f=sjcl.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.e(d,b);d.key=a;return 1===c.raw?f:sjcl.codec.utf8String.fromBits(f)},decrypt:function(a,b,
c,d){var e=sjcl.json;return e.X(a,e.decode(b),c,d)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b))switch(b.match(/^[a-z0-9]+$/i)||q(new sjcl.exception.invalid("json encode: invalid property name")),c+=d+'"'+b+'":',d=",",typeof a[b]){case "number":case "boolean":c+=a[b];break;case "string":c+='"'+escape(a[b])+'"';break;case "object":c+='"'+sjcl.codec.base64.fromBits(a[b],0)+'"';break;default:q(new sjcl.exception.bug("json encode: unsupported type"))}return c+"}"},decode:function(a){a=
a.replace(/\s/g,"");a.match(/^\{.*\}$/)||q(new sjcl.exception.invalid("json decode: this isn't json!"));a=a.replace(/^\{|\}$/g,"").split(/,/);var b={},c,d;for(c=0;c<a.length;c++)(d=a[c].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i))||q(new sjcl.exception.invalid("json decode: this isn't json!")),d[3]?b[d[2]]=parseInt(d[3],10):d[4]?b[d[2]]=d[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(d[4]):unescape(d[4]):d[5]&&(b[d[2]]="true"===
d[5]);return b},e:function(a,b,c){a===s&&(a={});if(b===s)return a;for(var d in b)b.hasOwnProperty(d)&&(c&&(a[d]!==s&&a[d]!==b[d])&&q(new sjcl.exception.invalid("required parameter overridden")),a[d]=b[d]);return a},fa:function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&a[d]!==b[d]&&(c[d]=a[d]);return c},ea:function(a,b){var c={},d;for(d=0;d<b.length;d++)a[b[d]]!==s&&(c[b[d]]=a[b[d]]);return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.ca={};
sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.ca,d;b=b||{};d=b.iter||1E3;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=b.salt===s?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d[c].slice(0),salt:c.slice(0)}};
</script>
	<script>
var bundle = '%3C!DOCTYPE%20HTML%3E%0A%0A%3Chtml%3E%0A%3Chead%3E%0A%09%3Ctitle%3Esecret%3C%2Ftitle%3E%0A%09%3Cmeta%20charset%3D%22utf-8%22%3E%0A%09%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice-width%2Cinitial-scale%3D1%22%3E%0A%09%3Cstyle%3E%0Abody%20%7B%0A%09margin%3A%200%20auto%3B%20padding%3A%200%201em%3B%20max-width%3A%2028em%3B%0A%09font-size%3A%20110%25%3B%20font-family%3A%20%22Helvetica%20Neue%22%2C%20sans-serif%3B%0A%7D%0Ap%20%7B%20color%3A%20%23333%3B%20line-height%3A%201.3%3B%20%7D%0Aa%20%7B%20color%3A%20%232980b9%3B%20text-decoration%3A%20none%3B%20%7D%0Ainput%2C%20button%2C%20textarea%20%7B%0A%09display%3A%20block%3B%20margin%3A%201em%200%3B%20box-sizing%3A%20border-box%3B%20width%3A%20100%25%3B%0A%09font-size%3A%20100%25%3B%0A%7D%0Ainput%2C%20textarea%20%7B%20padding%3A%20.4em%3B%20border%3A%201px%20solid%20%23888%3B%20border-radius%3A%20.2em%3B%20%7D%0Ainput.error%2C%20textarea.error%20%7B%20border-color%3A%20%23c0392b%3B%20%7D%0Abutton%20%7B%0A%09padding%3A%20.4em%3B%0A%09border%3A%20none%3B%20border-radius%3A%20.2em%3B%0A%09color%3A%20white%3B%20background-color%3A%20%232980b9%3B%0A%09cursor%3A%20pointer%3B%0A%7D%0Abutton%3Aactive%20%7B%20background-color%3A%20%231970a9%3B%20%7D%0Abutton.error%20%7B%20background-color%3A%20%23c0392b%3B%20%7D%0Atextarea%20%7B%20min-height%3A%207em%3B%20font-family%3A%20%22Helvetica%20Neue%22%2C%20sans-serif%3B%20%7D%0Apre%20%7B%0A%09padding%3A%20.6em%3B%0A%09color%3A%20%23333%3B%20background-color%3A%20%23eee%3B%0A%09border-radius%3A%20.2em%3B%0A%09word-wrap%3A%20auto%3B%20white-space%3A%20pre-wrap%3B%0A%7D%0A%0A%23hint%20%7B%0A%09display%3A%20none%3B%0A%09padding%3A%20.4em%20.5em%3B%20border-radius%3A%20.2em%3B%0A%09color%3A%20white%3B%20background-color%3A%20%23c0392b%3B%0A%7D%0A%09%3C%2Fstyle%3E%0A%3C%2Fhead%3E%0A%3Cbody%3E%0A%09%3Cp%3EThis%20file%20contains%20an%20encrypted%20message.%3C%2Fp%3E%0A%09%3Cp%20id%3D%22hint%22%3E%3C%2Fp%3E%0A%09%3Cinput%20type%3D%22password%22%20id%3D%22password%22%20placeholder%3D%22Enter%20the%20password.%22%2F%3E%0A%09%3Cbutton%20id%3D%22submit%22%3EDecrypt%20the%20secret%3C%2Fbutton%3E%0A%09%3Cpre%20id%3D%22message%22%3E%3C%2Fpre%3E%0A%09%3Cscript%3E%22use%20strict%22%3Bfunction%20q(a)%7Bthrow%20a%3B%7Dvar%20s%3Dvoid%200%2Cu%3D!1%3Bvar%20sjcl%3D%7Bcipher%3A%7B%7D%2Chash%3A%7B%7D%2Ckeyexchange%3A%7B%7D%2Cmode%3A%7B%7D%2Cmisc%3A%7B%7D%2Ccodec%3A%7B%7D%2Cexception%3A%7Bcorrupt%3Afunction(a)%7Bthis.toString%3Dfunction()%7Breturn%22CORRUPT%3A%20%22%2Bthis.message%7D%3Bthis.message%3Da%7D%2Cinvalid%3Afunction(a)%7Bthis.toString%3Dfunction()%7Breturn%22INVALID%3A%20%22%2Bthis.message%7D%3Bthis.message%3Da%7D%2Cbug%3Afunction(a)%7Bthis.toString%3Dfunction()%7Breturn%22BUG%3A%20%22%2Bthis.message%7D%3Bthis.message%3Da%7D%2CnotReady%3Afunction(a)%7Bthis.toString%3Dfunction()%7Breturn%22NOT%20READY%3A%20%22%2Bthis.message%7D%3Bthis.message%3Da%7D%7D%7D%3B%0A%22undefined%22!%3D%3Dtypeof%20module%26%26module.exports%26%26(module.exports%3Dsjcl)%3B%22function%22%3D%3D%3Dtypeof%20define%26%26define(%5B%5D%2Cfunction()%7Breturn%20sjcl%7D)%3B%0Asjcl.cipher.aes%3Dfunction(a)%7Bthis.k%5B0%5D%5B0%5D%5B0%5D%7C%7Cthis.D()%3Bvar%20b%2Cc%2Cd%2Ce%2Cf%3Dthis.k%5B0%5D%5B4%5D%2Cg%3Dthis.k%5B1%5D%3Bb%3Da.length%3Bvar%20h%3D1%3B4!%3D%3Db%26%26(6!%3D%3Db%26%268!%3D%3Db)%26%26q(new%20sjcl.exception.invalid(%22invalid%20aes%20key%20size%22))%3Bthis.b%3D%5Bd%3Da.slice(0)%2Ce%3D%5B%5D%5D%3Bfor(a%3Db%3Ba%3C4*b%2B28%3Ba%2B%2B)%7Bc%3Dd%5Ba-1%5D%3Bif(0%3D%3D%3Da%25b%7C%7C8%3D%3D%3Db%26%264%3D%3D%3Da%25b)c%3Df%5Bc%3E%3E%3E24%5D%3C%3C24%5Ef%5Bc%3E%3E16%26255%5D%3C%3C16%5Ef%5Bc%3E%3E8%26255%5D%3C%3C8%5Ef%5Bc%26255%5D%2C0%3D%3D%3Da%25b%26%26(c%3Dc%3C%3C8%5Ec%3E%3E%3E24%5Eh%3C%3C24%2Ch%3Dh%3C%3C1%5E283*(h%3E%3E7))%3Bd%5Ba%5D%3Dd%5Ba-b%5D%5Ec%7Dfor(b%3D0%3Ba%3Bb%2B%2B%2Ca--)c%3Dd%5Bb%263%3Fa%3Aa-4%5D%2Ce%5Bb%5D%3D4%3E%3Da%7C%7C4%3Eb%3Fc%3Ag%5B0%5D%5Bf%5Bc%3E%3E%3E24%5D%5D%5Eg%5B1%5D%5Bf%5Bc%3E%3E16%26255%5D%5D%5Eg%5B2%5D%5Bf%5Bc%3E%3E8%26255%5D%5D%5Eg%5B3%5D%5Bf%5Bc%26%0A255%5D%5D%7D%3B%0Asjcl.cipher.aes.prototype%3D%7Bencrypt%3Afunction(a)%7Breturn%20w(this%2Ca%2C0)%7D%2Cdecrypt%3Afunction(a)%7Breturn%20w(this%2Ca%2C1)%7D%2Ck%3A%5B%5B%5B%5D%2C%5B%5D%2C%5B%5D%2C%5B%5D%2C%5B%5D%5D%2C%5B%5B%5D%2C%5B%5D%2C%5B%5D%2C%5B%5D%2C%5B%5D%5D%5D%2CD%3Afunction()%7Bvar%20a%3Dthis.k%5B0%5D%2Cb%3Dthis.k%5B1%5D%2Cc%3Da%5B4%5D%2Cd%3Db%5B4%5D%2Ce%2Cf%2Cg%2Ch%3D%5B%5D%2Cl%3D%5B%5D%2Ck%2Cn%2Cm%2Cp%3Bfor(e%3D0%3B0x100%3Ee%3Be%2B%2B)l%5B(h%5Be%5D%3De%3C%3C1%5E283*(e%3E%3E7))%5Ee%5D%3De%3Bfor(f%3Dg%3D0%3B!c%5Bf%5D%3Bf%5E%3Dk%7C%7C1%2Cg%3Dl%5Bg%5D%7C%7C1)%7Bm%3Dg%5Eg%3C%3C1%5Eg%3C%3C2%5Eg%3C%3C3%5Eg%3C%3C4%3Bm%3Dm%3E%3E8%5Em%26255%5E99%3Bc%5Bf%5D%3Dm%3Bd%5Bm%5D%3Df%3Bn%3Dh%5Be%3Dh%5Bk%3Dh%5Bf%5D%5D%5D%3Bp%3D0x1010101*n%5E0x10001*e%5E0x101*k%5E0x1010100*f%3Bn%3D0x101*h%5Bm%5D%5E0x1010100*m%3Bfor(e%3D0%3B4%3Ee%3Be%2B%2B)a%5Be%5D%5Bf%5D%3Dn%3Dn%3C%3C24%5En%3E%3E%3E8%2Cb%5Be%5D%5Bm%5D%3Dp%3Dp%3C%3C24%5Ep%3E%3E%3E8%7Dfor(e%3D%0A0%3B5%3Ee%3Be%2B%2B)a%5Be%5D%3Da%5Be%5D.slice(0)%2Cb%5Be%5D%3Db%5Be%5D.slice(0)%7D%7D%3B%0Afunction%20w(a%2Cb%2Cc)%7B4!%3D%3Db.length%26%26q(new%20sjcl.exception.invalid(%22invalid%20aes%20block%20size%22))%3Bvar%20d%3Da.b%5Bc%5D%2Ce%3Db%5B0%5D%5Ed%5B0%5D%2Cf%3Db%5Bc%3F3%3A1%5D%5Ed%5B1%5D%2Cg%3Db%5B2%5D%5Ed%5B2%5D%3Bb%3Db%5Bc%3F1%3A3%5D%5Ed%5B3%5D%3Bvar%20h%2Cl%2Ck%2Cn%3Dd.length%2F4-2%2Cm%2Cp%3D4%2Ct%3D%5B0%2C0%2C0%2C0%5D%3Bh%3Da.k%5Bc%5D%3Ba%3Dh%5B0%5D%3Bvar%20r%3Dh%5B1%5D%2Cv%3Dh%5B2%5D%2Cy%3Dh%5B3%5D%2Cz%3Dh%5B4%5D%3Bfor(m%3D0%3Bm%3Cn%3Bm%2B%2B)h%3Da%5Be%3E%3E%3E24%5D%5Er%5Bf%3E%3E16%26255%5D%5Ev%5Bg%3E%3E8%26255%5D%5Ey%5Bb%26255%5D%5Ed%5Bp%5D%2Cl%3Da%5Bf%3E%3E%3E24%5D%5Er%5Bg%3E%3E16%26255%5D%5Ev%5Bb%3E%3E8%26255%5D%5Ey%5Be%26255%5D%5Ed%5Bp%2B1%5D%2Ck%3Da%5Bg%3E%3E%3E24%5D%5Er%5Bb%3E%3E16%26255%5D%5Ev%5Be%3E%3E8%26255%5D%5Ey%5Bf%26255%5D%5Ed%5Bp%2B2%5D%2Cb%3Da%5Bb%3E%3E%3E24%5D%5Er%5Be%3E%3E16%26255%5D%5Ev%5Bf%3E%3E8%26255%5D%5Ey%5Bg%26255%5D%5Ed%5Bp%2B3%5D%2Cp%2B%3D4%2Ce%3Dh%2Cf%3Dl%2Cg%3Dk%3Bfor(m%3D0%3B4%3E%0Am%3Bm%2B%2B)t%5Bc%3F3%26-m%3Am%5D%3Dz%5Be%3E%3E%3E24%5D%3C%3C24%5Ez%5Bf%3E%3E16%26255%5D%3C%3C16%5Ez%5Bg%3E%3E8%26255%5D%3C%3C8%5Ez%5Bb%26255%5D%5Ed%5Bp%2B%2B%5D%2Ch%3De%2Ce%3Df%2Cf%3Dg%2Cg%3Db%2Cb%3Dh%3Breturn%20t%7D%0Asjcl.bitArray%3D%7BbitSlice%3Afunction(a%2Cb%2Cc)%7Ba%3Dsjcl.bitArray.P(a.slice(b%2F32)%2C32-(b%2631)).slice(1)%3Breturn%20c%3D%3D%3Ds%3Fa%3Asjcl.bitArray.clamp(a%2Cc-b)%7D%2Cextract%3Afunction(a%2Cb%2Cc)%7Bvar%20d%3DMath.floor(-b-c%2631)%3Breturn((b%2Bc-1%5Eb)%26-32%3Fa%5Bb%2F32%7C0%5D%3C%3C32-d%5Ea%5Bb%2F32%2B1%7C0%5D%3E%3E%3Ed%3Aa%5Bb%2F32%7C0%5D%3E%3E%3Ed)%26(1%3C%3Cc)-1%7D%2Cconcat%3Afunction(a%2Cb)%7Bif(0%3D%3D%3Da.length%7C%7C0%3D%3D%3Db.length)return%20a.concat(b)%3Bvar%20c%3Da%5Ba.length-1%5D%2Cd%3Dsjcl.bitArray.getPartial(c)%3Breturn%2032%3D%3D%3Dd%3Fa.concat(b)%3Asjcl.bitArray.P(b%2Cd%2Cc%7C0%2Ca.slice(0%2Ca.length-1))%7D%2CbitLength%3Afunction(a)%7Bvar%20b%3Da.length%3Breturn%200%3D%3D%3D%0Ab%3F0%3A32*(b-1)%2Bsjcl.bitArray.getPartial(a%5Bb-1%5D)%7D%2Cclamp%3Afunction(a%2Cb)%7Bif(32*a.length%3Cb)return%20a%3Ba%3Da.slice(0%2CMath.ceil(b%2F32))%3Bvar%20c%3Da.length%3Bb%26%3D31%3B0%3Cc%26%26b%26%26(a%5Bc-1%5D%3Dsjcl.bitArray.partial(b%2Ca%5Bc-1%5D%262147483648%3E%3Eb-1%2C1))%3Breturn%20a%7D%2Cpartial%3Afunction(a%2Cb%2Cc)%7Breturn%2032%3D%3D%3Da%3Fb%3A(c%3Fb%7C0%3Ab%3C%3C32-a)%2B0x10000000000*a%7D%2CgetPartial%3Afunction(a)%7Breturn%20Math.round(a%2F0x10000000000)%7C%7C32%7D%2Cequal%3Afunction(a%2Cb)%7Bif(sjcl.bitArray.bitLength(a)!%3D%3Dsjcl.bitArray.bitLength(b))return%20u%3Bvar%20c%3D0%2Cd%3Bfor(d%3D0%3Bd%3Ca.length%3Bd%2B%2B)c%7C%3Da%5Bd%5D%5Eb%5Bd%5D%3Breturn%200%3D%3D%3D%0Ac%7D%2CP%3Afunction(a%2Cb%2Cc%2Cd)%7Bvar%20e%3Be%3D0%3Bfor(d%3D%3D%3Ds%26%26(d%3D%5B%5D)%3B32%3C%3Db%3Bb-%3D32)d.push(c)%2Cc%3D0%3Bif(0%3D%3D%3Db)return%20d.concat(a)%3Bfor(e%3D0%3Be%3Ca.length%3Be%2B%2B)d.push(c%7Ca%5Be%5D%3E%3E%3Eb)%2Cc%3Da%5Be%5D%3C%3C32-b%3Be%3Da.length%3Fa%5Ba.length-1%5D%3A0%3Ba%3Dsjcl.bitArray.getPartial(e)%3Bd.push(sjcl.bitArray.partial(b%2Ba%2631%2C32%3Cb%2Ba%3Fc%3Ad.pop()%2C1))%3Breturn%20d%7D%2Cl%3Afunction(a%2Cb)%7Breturn%5Ba%5B0%5D%5Eb%5B0%5D%2Ca%5B1%5D%5Eb%5B1%5D%2Ca%5B2%5D%5Eb%5B2%5D%2Ca%5B3%5D%5Eb%5B3%5D%5D%7D%2CbyteswapM%3Afunction(a)%7Bvar%20b%2Cc%3Bfor(b%3D0%3Bb%3Ca.length%3B%2B%2Bb)c%3Da%5Bb%5D%2Ca%5Bb%5D%3Dc%3E%3E%3E24%7Cc%3E%3E%3E8%260xff00%7C(c%260xff00)%3C%3C8%7Cc%3C%3C24%3Breturn%20a%7D%7D%3B%0Asjcl.codec.utf8String%3D%7BfromBits%3Afunction(a)%7Bvar%20b%3D%22%22%2Cc%3Dsjcl.bitArray.bitLength(a)%2Cd%2Ce%3Bfor(d%3D0%3Bd%3Cc%2F8%3Bd%2B%2B)0%3D%3D%3D(d%263)%26%26(e%3Da%5Bd%2F4%5D)%2Cb%2B%3DString.fromCharCode(e%3E%3E%3E24)%2Ce%3C%3C%3D8%3Breturn%20decodeURIComponent(escape(b))%7D%2CtoBits%3Afunction(a)%7Ba%3Dunescape(encodeURIComponent(a))%3Bvar%20b%3D%5B%5D%2Cc%2Cd%3D0%3Bfor(c%3D0%3Bc%3Ca.length%3Bc%2B%2B)d%3Dd%3C%3C8%7Ca.charCodeAt(c)%2C3%3D%3D%3D(c%263)%26%26(b.push(d)%2Cd%3D0)%3Bc%263%26%26b.push(sjcl.bitArray.partial(8*(c%263)%2Cd))%3Breturn%20b%7D%7D%3B%0Asjcl.codec.hex%3D%7BfromBits%3Afunction(a)%7Bvar%20b%3D%22%22%2Cc%3Bfor(c%3D0%3Bc%3Ca.length%3Bc%2B%2B)b%2B%3D((a%5Bc%5D%7C0)%2B0xf00000000000).toString(16).substr(4)%3Breturn%20b.substr(0%2Csjcl.bitArray.bitLength(a)%2F4)%7D%2CtoBits%3Afunction(a)%7Bvar%20b%2Cc%3D%5B%5D%2Cd%3Ba%3Da.replace(%2F%5Cs%7C0x%2Fg%2C%22%22)%3Bd%3Da.length%3Ba%2B%3D%2200000000%22%3Bfor(b%3D0%3Bb%3Ca.length%3Bb%2B%3D8)c.push(parseInt(a.substr(b%2C8)%2C16)%5E0)%3Breturn%20sjcl.bitArray.clamp(c%2C4*d)%7D%7D%3B%0Asjcl.codec.base64%3D%7BJ%3A%22ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%2B%2F%22%2CfromBits%3Afunction(a%2Cb%2Cc)%7Bvar%20d%3D%22%22%2Ce%3D0%2Cf%3Dsjcl.codec.base64.J%2Cg%3D0%2Ch%3Dsjcl.bitArray.bitLength(a)%3Bc%26%26(f%3Df.substr(0%2C62)%2B%22-_%22)%3Bfor(c%3D0%3B6*d.length%3Ch%3B)d%2B%3Df.charAt((g%5Ea%5Bc%5D%3E%3E%3Ee)%3E%3E%3E26)%2C6%3Ee%3F(g%3Da%5Bc%5D%3C%3C6-e%2Ce%2B%3D26%2Cc%2B%2B)%3A(g%3C%3C%3D6%2Ce-%3D6)%3Bfor(%3Bd.length%263%26%26!b%3B)d%2B%3D%22%3D%22%3Breturn%20d%7D%2CtoBits%3Afunction(a%2Cb)%7Ba%3Da.replace(%2F%5Cs%7C%3D%2Fg%2C%22%22)%3Bvar%20c%3D%5B%5D%2Cd%2Ce%3D0%2Cf%3Dsjcl.codec.base64.J%2Cg%3D0%2Ch%3Bb%26%26(f%3Df.substr(0%2C62)%2B%22-_%22)%3Bfor(d%3D0%3Bd%3Ca.length%3Bd%2B%2B)h%3Df.indexOf(a.charAt(d))%2C%0A0%3Eh%26%26q(new%20sjcl.exception.invalid(%22this%20isn\'t%20base64!%22))%2C26%3Ce%3F(e-%3D26%2Cc.push(g%5Eh%3E%3E%3Ee)%2Cg%3Dh%3C%3C32-e)%3A(e%2B%3D6%2Cg%5E%3Dh%3C%3C32-e)%3Be%2656%26%26c.push(sjcl.bitArray.partial(e%2656%2Cg%2C1))%3Breturn%20c%7D%7D%3Bsjcl.codec.base64url%3D%7BfromBits%3Afunction(a)%7Breturn%20sjcl.codec.base64.fromBits(a%2C1%2C1)%7D%2CtoBits%3Afunction(a)%7Breturn%20sjcl.codec.base64.toBits(a%2C1)%7D%7D%3Bsjcl.hash.sha256%3Dfunction(a)%7Bthis.b%5B0%5D%7C%7Cthis.D()%3Ba%3F(this.r%3Da.r.slice(0)%2Cthis.o%3Da.o.slice(0)%2Cthis.h%3Da.h)%3Athis.reset()%7D%3Bsjcl.hash.sha256.hash%3Dfunction(a)%7Breturn(new%20sjcl.hash.sha256).update(a).finalize()%7D%3B%0Asjcl.hash.sha256.prototype%3D%7BblockSize%3A512%2Creset%3Afunction()%7Bthis.r%3Dthis.N.slice(0)%3Bthis.o%3D%5B%5D%3Bthis.h%3D0%3Breturn%20this%7D%2Cupdate%3Afunction(a)%7B%22string%22%3D%3D%3Dtypeof%20a%26%26(a%3Dsjcl.codec.utf8String.toBits(a))%3Bvar%20b%2Cc%3Dthis.o%3Dsjcl.bitArray.concat(this.o%2Ca)%3Bb%3Dthis.h%3Ba%3Dthis.h%3Db%2Bsjcl.bitArray.bitLength(a)%3Bfor(b%3D512%2Bb%26-512%3Bb%3C%3Da%3Bb%2B%3D512)x(this%2Cc.splice(0%2C16))%3Breturn%20this%7D%2Cfinalize%3Afunction()%7Bvar%20a%2Cb%3Dthis.o%2Cc%3Dthis.r%2Cb%3Dsjcl.bitArray.concat(b%2C%5Bsjcl.bitArray.partial(1%2C1)%5D)%3Bfor(a%3Db.length%2B2%3Ba%2615%3Ba%2B%2B)b.push(0)%3Bb.push(Math.floor(this.h%2F%0A4294967296))%3Bfor(b.push(this.h%7C0)%3Bb.length%3B)x(this%2Cb.splice(0%2C16))%3Bthis.reset()%3Breturn%20c%7D%2CN%3A%5B%5D%2Cb%3A%5B%5D%2CD%3Afunction()%7Bfunction%20a(a)%7Breturn%200x100000000*(a-Math.floor(a))%7C0%7Dvar%20b%3D0%2Cc%3D2%2Cd%3Ba%3Afor(%3B64%3Eb%3Bc%2B%2B)%7Bfor(d%3D2%3Bd*d%3C%3Dc%3Bd%2B%2B)if(0%3D%3D%3Dc%25d)continue%20a%3B8%3Eb%26%26(this.N%5Bb%5D%3Da(Math.pow(c%2C0.5)))%3Bthis.b%5Bb%5D%3Da(Math.pow(c%2C1%2F3))%3Bb%2B%2B%7D%7D%7D%3B%0Afunction%20x(a%2Cb)%7Bvar%20c%2Cd%2Ce%2Cf%3Db.slice(0)%2Cg%3Da.r%2Ch%3Da.b%2Cl%3Dg%5B0%5D%2Ck%3Dg%5B1%5D%2Cn%3Dg%5B2%5D%2Cm%3Dg%5B3%5D%2Cp%3Dg%5B4%5D%2Ct%3Dg%5B5%5D%2Cr%3Dg%5B6%5D%2Cv%3Dg%5B7%5D%3Bfor(c%3D0%3B64%3Ec%3Bc%2B%2B)16%3Ec%3Fd%3Df%5Bc%5D%3A(d%3Df%5Bc%2B1%2615%5D%2Ce%3Df%5Bc%2B14%2615%5D%2Cd%3Df%5Bc%2615%5D%3D(d%3E%3E%3E7%5Ed%3E%3E%3E18%5Ed%3E%3E%3E3%5Ed%3C%3C25%5Ed%3C%3C14)%2B(e%3E%3E%3E17%5Ee%3E%3E%3E19%5Ee%3E%3E%3E10%5Ee%3C%3C15%5Ee%3C%3C13)%2Bf%5Bc%2615%5D%2Bf%5Bc%2B9%2615%5D%7C0)%2Cd%3Dd%2Bv%2B(p%3E%3E%3E6%5Ep%3E%3E%3E11%5Ep%3E%3E%3E25%5Ep%3C%3C26%5Ep%3C%3C21%5Ep%3C%3C7)%2B(r%5Ep%26(t%5Er))%2Bh%5Bc%5D%2Cv%3Dr%2Cr%3Dt%2Ct%3Dp%2Cp%3Dm%2Bd%7C0%2Cm%3Dn%2Cn%3Dk%2Ck%3Dl%2Cl%3Dd%2B(k%26n%5Em%26(k%5En))%2B(k%3E%3E%3E2%5Ek%3E%3E%3E13%5Ek%3E%3E%3E22%5Ek%3C%3C30%5Ek%3C%3C19%5Ek%3C%3C10)%7C0%3Bg%5B0%5D%3Dg%5B0%5D%2Bl%7C0%3Bg%5B1%5D%3Dg%5B1%5D%2Bk%7C0%3Bg%5B2%5D%3Dg%5B2%5D%2Bn%7C0%3Bg%5B3%5D%3Dg%5B3%5D%2Bm%7C0%3Bg%5B4%5D%3Dg%5B4%5D%2Bp%7C0%3Bg%5B5%5D%3Dg%5B5%5D%2Bt%7C0%3Bg%5B6%5D%3D%0Ag%5B6%5D%2Br%7C0%3Bg%5B7%5D%3Dg%5B7%5D%2Bv%7C0%7D%0Asjcl.mode.ccm%3D%7Bname%3A%22ccm%22%2Cencrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce)%7Bvar%20f%2Cg%3Db.slice(0)%2Ch%3Dsjcl.bitArray%2Cl%3Dh.bitLength(c)%2F8%2Ck%3Dh.bitLength(g)%2F8%3Be%3De%7C%7C64%3Bd%3Dd%7C%7C%5B%5D%3B7%3El%26%26q(new%20sjcl.exception.invalid(%22ccm%3A%20iv%20must%20be%20at%20least%207%20bytes%22))%3Bfor(f%3D2%3B4%3Ef%26%26k%3E%3E%3E8*f%3Bf%2B%2B)%3Bf%3C15-l%26%26(f%3D15-l)%3Bc%3Dh.clamp(c%2C8*(15-f))%3Bb%3Dsjcl.mode.ccm.L(a%2Cb%2Cc%2Cd%2Ce%2Cf)%3Bg%3Dsjcl.mode.ccm.p(a%2Cg%2Cc%2Cb%2Ce%2Cf)%3Breturn%20h.concat(g.data%2Cg.tag)%7D%2Cdecrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce)%7Be%3De%7C%7C64%3Bd%3Dd%7C%7C%5B%5D%3Bvar%20f%3Dsjcl.bitArray%2Cg%3Df.bitLength(c)%2F8%2Ch%3Df.bitLength(b)%2Cl%3Df.clamp(b%2Ch-e)%2Ck%3Df.bitSlice(b%2C%0Ah-e)%2Ch%3D(h-e)%2F8%3B7%3Eg%26%26q(new%20sjcl.exception.invalid(%22ccm%3A%20iv%20must%20be%20at%20least%207%20bytes%22))%3Bfor(b%3D2%3B4%3Eb%26%26h%3E%3E%3E8*b%3Bb%2B%2B)%3Bb%3C15-g%26%26(b%3D15-g)%3Bc%3Df.clamp(c%2C8*(15-b))%3Bl%3Dsjcl.mode.ccm.p(a%2Cl%2Cc%2Ck%2Ce%2Cb)%3Ba%3Dsjcl.mode.ccm.L(a%2Cl.data%2Cc%2Cd%2Ce%2Cb)%3Bf.equal(l.tag%2Ca)%7C%7Cq(new%20sjcl.exception.corrupt(%22ccm%3A%20tag%20doesn\'t%20match%22))%3Breturn%20l.data%7D%2CL%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7Bvar%20g%3D%5B%5D%2Ch%3Dsjcl.bitArray%2Cl%3Dh.l%3Be%2F%3D8%3B(e%252%7C%7C4%3Ee%7C%7C16%3Ce)%26%26q(new%20sjcl.exception.invalid(%22ccm%3A%20invalid%20tag%20length%22))%3B(0xffffffff%3Cd.length%7C%7C0xffffffff%3Cb.length)%26%26q(new%20sjcl.exception.bug(%22ccm%3A%20can\'t%20deal%20with%204GiB%20or%20more%20data%22))%3B%0Af%3D%5Bh.partial(8%2C(d.length%3F64%3A0)%7Ce-2%3C%3C2%7Cf-1)%5D%3Bf%3Dh.concat(f%2Cc)%3Bf%5B3%5D%7C%3Dh.bitLength(b)%2F8%3Bf%3Da.encrypt(f)%3Bif(d.length)%7Bc%3Dh.bitLength(d)%2F8%3B65279%3E%3Dc%3Fg%3D%5Bh.partial(16%2Cc)%5D%3A0xffffffff%3E%3Dc%26%26(g%3Dh.concat(%5Bh.partial(16%2C65534)%5D%2C%5Bc%5D))%3Bg%3Dh.concat(g%2Cd)%3Bfor(d%3D0%3Bd%3Cg.length%3Bd%2B%3D4)f%3Da.encrypt(l(f%2Cg.slice(d%2Cd%2B4).concat(%5B0%2C0%2C0%5D)))%7Dfor(d%3D0%3Bd%3Cb.length%3Bd%2B%3D4)f%3Da.encrypt(l(f%2Cb.slice(d%2Cd%2B4).concat(%5B0%2C0%2C0%5D)))%3Breturn%20h.clamp(f%2C8*e)%7D%2Cp%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7Bvar%20g%2Ch%3Dsjcl.bitArray%3Bg%3Dh.l%3Bvar%20l%3Db.length%2Ck%3Dh.bitLength(b)%3Bc%3Dh.concat(%5Bh.partial(8%2C%0Af-1)%5D%2Cc).concat(%5B0%2C0%2C0%5D).slice(0%2C4)%3Bd%3Dh.bitSlice(g(d%2Ca.encrypt(c))%2C0%2Ce)%3Bif(!l)return%7Btag%3Ad%2Cdata%3A%5B%5D%7D%3Bfor(g%3D0%3Bg%3Cl%3Bg%2B%3D4)c%5B3%5D%2B%2B%2Ce%3Da.encrypt(c)%2Cb%5Bg%5D%5E%3De%5B0%5D%2Cb%5Bg%2B1%5D%5E%3De%5B1%5D%2Cb%5Bg%2B2%5D%5E%3De%5B2%5D%2Cb%5Bg%2B3%5D%5E%3De%5B3%5D%3Breturn%7Btag%3Ad%2Cdata%3Ah.clamp(b%2Ck)%7D%7D%7D%3B%0Asjcl.mode.ocb2%3D%7Bname%3A%22ocb2%22%2Cencrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7B128!%3D%3Dsjcl.bitArray.bitLength(c)%26%26q(new%20sjcl.exception.invalid(%22ocb%20iv%20must%20be%20128%20bits%22))%3Bvar%20g%2Ch%3Dsjcl.mode.ocb2.H%2Cl%3Dsjcl.bitArray%2Ck%3Dl.l%2Cn%3D%5B0%2C0%2C0%2C0%5D%3Bc%3Dh(a.encrypt(c))%3Bvar%20m%2Cp%3D%5B%5D%3Bd%3Dd%7C%7C%5B%5D%3Be%3De%7C%7C64%3Bfor(g%3D0%3Bg%2B4%3Cb.length%3Bg%2B%3D4)m%3Db.slice(g%2Cg%2B4)%2Cn%3Dk(n%2Cm)%2Cp%3Dp.concat(k(c%2Ca.encrypt(k(c%2Cm))))%2Cc%3Dh(c)%3Bm%3Db.slice(g)%3Bb%3Dl.bitLength(m)%3Bg%3Da.encrypt(k(c%2C%5B0%2C0%2C0%2Cb%5D))%3Bm%3Dl.clamp(k(m.concat(%5B0%2C0%2C0%5D)%2Cg)%2Cb)%3Bn%3Dk(n%2Ck(m.concat(%5B0%2C0%2C0%5D)%2Cg))%3Bn%3Da.encrypt(k(n%2Ck(c%2Ch(c))))%3Bd.length%26%26%0A(n%3Dk(n%2Cf%3Fd%3Asjcl.mode.ocb2.pmac(a%2Cd)))%3Breturn%20p.concat(l.concat(m%2Cl.clamp(n%2Ce)))%7D%2Cdecrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7B128!%3D%3Dsjcl.bitArray.bitLength(c)%26%26q(new%20sjcl.exception.invalid(%22ocb%20iv%20must%20be%20128%20bits%22))%3Be%3De%7C%7C64%3Bvar%20g%3Dsjcl.mode.ocb2.H%2Ch%3Dsjcl.bitArray%2Cl%3Dh.l%2Ck%3D%5B0%2C0%2C0%2C0%5D%2Cn%3Dg(a.encrypt(c))%2Cm%2Cp%2Ct%3Dsjcl.bitArray.bitLength(b)-e%2Cr%3D%5B%5D%3Bd%3Dd%7C%7C%5B%5D%3Bfor(c%3D0%3Bc%2B4%3Ct%2F32%3Bc%2B%3D4)m%3Dl(n%2Ca.decrypt(l(n%2Cb.slice(c%2Cc%2B4))))%2Ck%3Dl(k%2Cm)%2Cr%3Dr.concat(m)%2Cn%3Dg(n)%3Bp%3Dt-32*c%3Bm%3Da.encrypt(l(n%2C%5B0%2C0%2C0%2Cp%5D))%3Bm%3Dl(m%2Ch.clamp(b.slice(c)%2Cp).concat(%5B0%2C0%2C0%5D))%3B%0Ak%3Dl(k%2Cm)%3Bk%3Da.encrypt(l(k%2Cl(n%2Cg(n))))%3Bd.length%26%26(k%3Dl(k%2Cf%3Fd%3Asjcl.mode.ocb2.pmac(a%2Cd)))%3Bh.equal(h.clamp(k%2Ce)%2Ch.bitSlice(b%2Ct))%7C%7Cq(new%20sjcl.exception.corrupt(%22ocb%3A%20tag%20doesn\'t%20match%22))%3Breturn%20r.concat(h.clamp(m%2Cp))%7D%2Cpmac%3Afunction(a%2Cb)%7Bvar%20c%2Cd%3Dsjcl.mode.ocb2.H%2Ce%3Dsjcl.bitArray%2Cf%3De.l%2Cg%3D%5B0%2C0%2C0%2C0%5D%2Ch%3Da.encrypt(%5B0%2C0%2C0%2C0%5D)%2Ch%3Df(h%2Cd(d(h)))%3Bfor(c%3D0%3Bc%2B4%3Cb.length%3Bc%2B%3D4)h%3Dd(h)%2Cg%3Df(g%2Ca.encrypt(f(h%2Cb.slice(c%2Cc%2B4))))%3Bc%3Db.slice(c)%3B128%3Ee.bitLength(c)%26%26(h%3Df(h%2Cd(h))%2Cc%3De.concat(c%2C%5B-2147483648%2C0%2C0%2C0%5D))%3Bg%3Df(g%2Cc)%3Breturn%20a.encrypt(f(d(f(h%2C%0Ad(h)))%2Cg))%7D%2CH%3Afunction(a)%7Breturn%5Ba%5B0%5D%3C%3C1%5Ea%5B1%5D%3E%3E%3E31%2Ca%5B1%5D%3C%3C1%5Ea%5B2%5D%3E%3E%3E31%2Ca%5B2%5D%3C%3C1%5Ea%5B3%5D%3E%3E%3E31%2Ca%5B3%5D%3C%3C1%5E135*(a%5B0%5D%3E%3E%3E31)%5D%7D%7D%3B%0Asjcl.mode.gcm%3D%7Bname%3A%22gcm%22%2Cencrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce)%7Bvar%20f%3Db.slice(0)%3Bb%3Dsjcl.bitArray%3Bd%3Dd%7C%7C%5B%5D%3Ba%3Dsjcl.mode.gcm.p(!0%2Ca%2Cf%2Cd%2Cc%2Ce%7C%7C128)%3Breturn%20b.concat(a.data%2Ca.tag)%7D%2Cdecrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce)%7Bvar%20f%3Db.slice(0)%2Cg%3Dsjcl.bitArray%2Ch%3Dg.bitLength(f)%3Be%3De%7C%7C128%3Bd%3Dd%7C%7C%5B%5D%3Be%3C%3Dh%3F(b%3Dg.bitSlice(f%2Ch-e)%2Cf%3Dg.bitSlice(f%2C0%2Ch-e))%3A(b%3Df%2Cf%3D%5B%5D)%3Ba%3Dsjcl.mode.gcm.p(u%2Ca%2Cf%2Cd%2Cc%2Ce)%3Bg.equal(a.tag%2Cb)%7C%7Cq(new%20sjcl.exception.corrupt(%22gcm%3A%20tag%20doesn\'t%20match%22))%3Breturn%20a.data%7D%2CZ%3Afunction(a%2Cb)%7Bvar%20c%2Cd%2Ce%2Cf%2Cg%2Ch%3Dsjcl.bitArray.l%3Be%3D%5B0%2C0%2C0%2C0%5D%3Bf%3Db.slice(0)%3B%0Afor(c%3D0%3B128%3Ec%3Bc%2B%2B)%7B(d%3D0!%3D%3D(a%5BMath.floor(c%2F32)%5D%261%3C%3C31-c%2532))%26%26(e%3Dh(e%2Cf))%3Bg%3D0!%3D%3D(f%5B3%5D%261)%3Bfor(d%3D3%3B0%3Cd%3Bd--)f%5Bd%5D%3Df%5Bd%5D%3E%3E%3E1%7C(f%5Bd-1%5D%261)%3C%3C31%3Bf%5B0%5D%3E%3E%3E%3D1%3Bg%26%26(f%5B0%5D%5E%3D-0x1f000000)%7Dreturn%20e%7D%2Cg%3Afunction(a%2Cb%2Cc)%7Bvar%20d%2Ce%3Dc.length%3Bb%3Db.slice(0)%3Bfor(d%3D0%3Bd%3Ce%3Bd%2B%3D4)b%5B0%5D%5E%3D0xffffffff%26c%5Bd%5D%2Cb%5B1%5D%5E%3D0xffffffff%26c%5Bd%2B1%5D%2Cb%5B2%5D%5E%3D0xffffffff%26c%5Bd%2B2%5D%2Cb%5B3%5D%5E%3D0xffffffff%26c%5Bd%2B3%5D%2Cb%3Dsjcl.mode.gcm.Z(b%2Ca)%3Breturn%20b%7D%2Cp%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7Bvar%20g%2Ch%2Cl%2Ck%2Cn%2Cm%2Cp%2Ct%2Cr%3Dsjcl.bitArray%3Bm%3Dc.length%3Bp%3Dr.bitLength(c)%3Bt%3Dr.bitLength(d)%3Bh%3Dr.bitLength(e)%3Bg%3Db.encrypt(%5B0%2C%0A0%2C0%2C0%5D)%3B96%3D%3D%3Dh%3F(e%3De.slice(0)%2Ce%3Dr.concat(e%2C%5B1%5D))%3A(e%3Dsjcl.mode.gcm.g(g%2C%5B0%2C0%2C0%2C0%5D%2Ce)%2Ce%3Dsjcl.mode.gcm.g(g%2Ce%2C%5B0%2C0%2CMath.floor(h%2F0x100000000)%2Ch%260xffffffff%5D))%3Bh%3Dsjcl.mode.gcm.g(g%2C%5B0%2C0%2C0%2C0%5D%2Cd)%3Bn%3De.slice(0)%3Bd%3Dh.slice(0)%3Ba%7C%7C(d%3Dsjcl.mode.gcm.g(g%2Ch%2Cc))%3Bfor(k%3D0%3Bk%3Cm%3Bk%2B%3D4)n%5B3%5D%2B%2B%2Cl%3Db.encrypt(n)%2Cc%5Bk%5D%5E%3Dl%5B0%5D%2Cc%5Bk%2B1%5D%5E%3Dl%5B1%5D%2Cc%5Bk%2B2%5D%5E%3Dl%5B2%5D%2Cc%5Bk%2B3%5D%5E%3Dl%5B3%5D%3Bc%3Dr.clamp(c%2Cp)%3Ba%26%26(d%3Dsjcl.mode.gcm.g(g%2Ch%2Cc))%3Ba%3D%5BMath.floor(t%2F0x100000000)%2Ct%260xffffffff%2CMath.floor(p%2F0x100000000)%2Cp%260xffffffff%5D%3Bd%3Dsjcl.mode.gcm.g(g%2Cd%2Ca)%3Bl%3Db.encrypt(e)%3Bd%5B0%5D%5E%3Dl%5B0%5D%3B%0Ad%5B1%5D%5E%3Dl%5B1%5D%3Bd%5B2%5D%5E%3Dl%5B2%5D%3Bd%5B3%5D%5E%3Dl%5B3%5D%3Breturn%7Btag%3Ar.bitSlice(d%2C0%2Cf)%2Cdata%3Ac%7D%7D%7D%3Bsjcl.misc.hmac%3Dfunction(a%2Cb)%7Bthis.M%3Db%3Db%7C%7Csjcl.hash.sha256%3Bvar%20c%3D%5B%5B%5D%2C%5B%5D%5D%2Cd%2Ce%3Db.prototype.blockSize%2F32%3Bthis.n%3D%5Bnew%20b%2Cnew%20b%5D%3Ba.length%3Ee%26%26(a%3Db.hash(a))%3Bfor(d%3D0%3Bd%3Ce%3Bd%2B%2B)c%5B0%5D%5Bd%5D%3Da%5Bd%5D%5E909522486%2Cc%5B1%5D%5Bd%5D%3Da%5Bd%5D%5E1549556828%3Bthis.n%5B0%5D.update(c%5B0%5D)%3Bthis.n%5B1%5D.update(c%5B1%5D)%3Bthis.G%3Dnew%20b(this.n%5B0%5D)%7D%3B%0Asjcl.misc.hmac.prototype.encrypt%3Dsjcl.misc.hmac.prototype.mac%3Dfunction(a)%7Bthis.Q%26%26q(new%20sjcl.exception.invalid(%22encrypt%20on%20already%20updated%20hmac%20called!%22))%3Bthis.update(a)%3Breturn%20this.digest(a)%7D%3Bsjcl.misc.hmac.prototype.reset%3Dfunction()%7Bthis.G%3Dnew%20this.M(this.n%5B0%5D)%3Bthis.Q%3Du%7D%3Bsjcl.misc.hmac.prototype.update%3Dfunction(a)%7Bthis.Q%3D!0%3Bthis.G.update(a)%7D%3Bsjcl.misc.hmac.prototype.digest%3Dfunction()%7Bvar%20a%3Dthis.G.finalize()%2Ca%3D(new%20this.M(this.n%5B1%5D)).update(a).finalize()%3Bthis.reset()%3Breturn%20a%7D%3B%0Asjcl.misc.pbkdf2%3Dfunction(a%2Cb%2Cc%2Cd%2Ce)%7Bc%3Dc%7C%7C1E3%3B(0%3Ed%7C%7C0%3Ec)%26%26q(sjcl.exception.invalid(%22invalid%20params%20to%20pbkdf2%22))%3B%22string%22%3D%3D%3Dtypeof%20a%26%26(a%3Dsjcl.codec.utf8String.toBits(a))%3B%22string%22%3D%3D%3Dtypeof%20b%26%26(b%3Dsjcl.codec.utf8String.toBits(b))%3Be%3De%7C%7Csjcl.misc.hmac%3Ba%3Dnew%20e(a)%3Bvar%20f%2Cg%2Ch%2Cl%2Ck%3D%5B%5D%2Cn%3Dsjcl.bitArray%3Bfor(l%3D1%3B32*k.length%3C(d%7C%7C1)%3Bl%2B%2B)%7Be%3Df%3Da.encrypt(n.concat(b%2C%5Bl%5D))%3Bfor(g%3D1%3Bg%3Cc%3Bg%2B%2B)%7Bf%3Da.encrypt(f)%3Bfor(h%3D0%3Bh%3Cf.length%3Bh%2B%2B)e%5Bh%5D%5E%3Df%5Bh%5D%7Dk%3Dk.concat(e)%7Dd%26%26(k%3Dn.clamp(k%2Cd))%3Breturn%20k%7D%3B%0Asjcl.prng%3Dfunction(a)%7Bthis.c%3D%5Bnew%20sjcl.hash.sha256%5D%3Bthis.i%3D%5B0%5D%3Bthis.F%3D0%3Bthis.s%3D%7B%7D%3Bthis.C%3D0%3Bthis.K%3D%7B%7D%3Bthis.O%3Dthis.d%3Dthis.j%3Dthis.W%3D0%3Bthis.b%3D%5B0%2C0%2C0%2C0%2C0%2C0%2C0%2C0%5D%3Bthis.f%3D%5B0%2C0%2C0%2C0%5D%3Bthis.A%3Ds%3Bthis.B%3Da%3Bthis.q%3Du%3Bthis.w%3D%7Bprogress%3A%7B%7D%2Cseeded%3A%7B%7D%7D%3Bthis.m%3Dthis.V%3D0%3Bthis.t%3D1%3Bthis.u%3D2%3Bthis.S%3D0x10000%3Bthis.I%3D%5B0%2C48%2C64%2C96%2C128%2C192%2C0x100%2C384%2C512%2C768%2C1024%5D%3Bthis.T%3D3E4%3Bthis.R%3D80%7D%3B%0Asjcl.prng.prototype%3D%7BrandomWords%3Afunction(a%2Cb)%7Bvar%20c%3D%5B%5D%2Cd%3Bd%3Dthis.isReady(b)%3Bvar%20e%3Bd%3D%3D%3Dthis.m%26%26q(new%20sjcl.exception.notReady(%22generator%20isn\'t%20seeded%22))%3Bif(d%26this.u)%7Bd%3D!(d%26this.t)%3Be%3D%5B%5D%3Bvar%20f%3D0%2Cg%3Bthis.O%3De%5B0%5D%3D(new%20Date).valueOf()%2Bthis.T%3Bfor(g%3D0%3B16%3Eg%3Bg%2B%2B)e.push(0x100000000*Math.random()%7C0)%3Bfor(g%3D0%3Bg%3Cthis.c.length%26%26!(e%3De.concat(this.c%5Bg%5D.finalize())%2Cf%2B%3Dthis.i%5Bg%5D%2Cthis.i%5Bg%5D%3D0%2C!d%26%26this.F%261%3C%3Cg)%3Bg%2B%2B)%3Bthis.F%3E%3D1%3C%3Cthis.c.length%26%26(this.c.push(new%20sjcl.hash.sha256)%2Cthis.i.push(0))%3Bthis.d-%3Df%3Bf%3Ethis.j%26%26(this.j%3Df)%3Bthis.F%2B%2B%3B%0Athis.b%3Dsjcl.hash.sha256.hash(this.b.concat(e))%3Bthis.A%3Dnew%20sjcl.cipher.aes(this.b)%3Bfor(d%3D0%3B4%3Ed%26%26!(this.f%5Bd%5D%3Dthis.f%5Bd%5D%2B1%7C0%2Cthis.f%5Bd%5D)%3Bd%2B%2B)%3B%7Dfor(d%3D0%3Bd%3Ca%3Bd%2B%3D4)0%3D%3D%3D(d%2B1)%25this.S%26%26A(this)%2Ce%3DB(this)%2Cc.push(e%5B0%5D%2Ce%5B1%5D%2Ce%5B2%5D%2Ce%5B3%5D)%3BA(this)%3Breturn%20c.slice(0%2Ca)%7D%2CsetDefaultParanoia%3Afunction(a%2Cb)%7B0%3D%3D%3Da%26%26%22Setting%20paranoia%3D0%20will%20ruin%20your%20security%3B%20use%20it%20only%20for%20testing%22!%3D%3Db%26%26q(%22Setting%20paranoia%3D0%20will%20ruin%20your%20security%3B%20use%20it%20only%20for%20testing%22)%3Bthis.B%3Da%7D%2CaddEntropy%3Afunction(a%2Cb%2Cc)%7Bc%3Dc%7C%7C%22user%22%3Bvar%20d%2Ce%2Cf%3D(new%20Date).valueOf()%2C%0Ag%3Dthis.s%5Bc%5D%2Ch%3Dthis.isReady()%2Cl%3D0%3Bd%3Dthis.K%5Bc%5D%3Bd%3D%3D%3Ds%26%26(d%3Dthis.K%5Bc%5D%3Dthis.W%2B%2B)%3Bg%3D%3D%3Ds%26%26(g%3Dthis.s%5Bc%5D%3D0)%3Bthis.s%5Bc%5D%3D(this.s%5Bc%5D%2B1)%25this.c.length%3Bswitch(typeof%20a)%7Bcase%20%22number%22%3Ab%3D%3D%3Ds%26%26(b%3D1)%3Bthis.c%5Bg%5D.update(%5Bd%2Cthis.C%2B%2B%2C1%2Cb%2Cf%2C1%2Ca%7C0%5D)%3Bbreak%3Bcase%20%22object%22%3Ac%3DObject.prototype.toString.call(a)%3Bif(%22%5Bobject%20Uint32Array%5D%22%3D%3D%3Dc)%7Be%3D%5B%5D%3Bfor(c%3D0%3Bc%3Ca.length%3Bc%2B%2B)e.push(a%5Bc%5D)%3Ba%3De%7Delse%7B%22%5Bobject%20Array%5D%22!%3D%3Dc%26%26(l%3D1)%3Bfor(c%3D0%3Bc%3Ca.length%26%26!l%3Bc%2B%2B)%22number%22!%3D%3Dtypeof%20a%5Bc%5D%26%26(l%3D1)%7Dif(!l)%7Bif(b%3D%3D%3Ds)for(c%3Db%3D0%3Bc%3Ca.length%3Bc%2B%2B)for(e%3Da%5Bc%5D%3B0%3Ce%3B)b%2B%2B%2C%0Ae%3E%3E%3E%3D1%3Bthis.c%5Bg%5D.update(%5Bd%2Cthis.C%2B%2B%2C2%2Cb%2Cf%2Ca.length%5D.concat(a))%7Dbreak%3Bcase%20%22string%22%3Ab%3D%3D%3Ds%26%26(b%3Da.length)%3Bthis.c%5Bg%5D.update(%5Bd%2Cthis.C%2B%2B%2C3%2Cb%2Cf%2Ca.length%5D)%3Bthis.c%5Bg%5D.update(a)%3Bbreak%3Bdefault%3Al%3D1%7Dl%26%26q(new%20sjcl.exception.bug(%22random%3A%20addEntropy%20only%20supports%20number%2C%20array%20of%20numbers%20or%20string%22))%3Bthis.i%5Bg%5D%2B%3Db%3Bthis.d%2B%3Db%3Bh%3D%3D%3Dthis.m%26%26(this.isReady()!%3D%3Dthis.m%26%26C(%22seeded%22%2CMath.max(this.j%2Cthis.d))%2CC(%22progress%22%2Cthis.getProgress()))%7D%2CisReady%3Afunction(a)%7Ba%3Dthis.I%5Ba!%3D%3Ds%3Fa%3Athis.B%5D%3Breturn%20this.j%26%26this.j%3E%3Da%3Fthis.i%5B0%5D%3Ethis.R%26%26%0A(new%20Date).valueOf()%3Ethis.O%3Fthis.u%7Cthis.t%3Athis.t%3Athis.d%3E%3Da%3Fthis.u%7Cthis.m%3Athis.m%7D%2CgetProgress%3Afunction(a)%7Ba%3Dthis.I%5Ba%3Fa%3Athis.B%5D%3Breturn%20this.j%3E%3Da%3F1%3Athis.d%3Ea%3F1%3Athis.d%2Fa%7D%2CstartCollectors%3Afunction()%7Bthis.q%7C%7C(this.a%3D%7BloadTimeCollector%3AD(this%2Cthis.aa)%2CmouseCollector%3AD(this%2Cthis.ba)%2CkeyboardCollector%3AD(this%2Cthis.%24)%2CaccelerometerCollector%3AD(this%2Cthis.U)%2CtouchCollector%3AD(this%2Cthis.da)%7D%2Cwindow.addEventListener%3F(window.addEventListener(%22load%22%2Cthis.a.loadTimeCollector%2Cu)%2Cwindow.addEventListener(%22mousemove%22%2Cthis.a.mouseCollector%2C%0Au)%2Cwindow.addEventListener(%22keypress%22%2Cthis.a.keyboardCollector%2Cu)%2Cwindow.addEventListener(%22devicemotion%22%2Cthis.a.accelerometerCollector%2Cu)%2Cwindow.addEventListener(%22touchmove%22%2Cthis.a.touchCollector%2Cu))%3Adocument.attachEvent%3F(document.attachEvent(%22onload%22%2Cthis.a.loadTimeCollector)%2Cdocument.attachEvent(%22onmousemove%22%2Cthis.a.mouseCollector)%2Cdocument.attachEvent(%22keypress%22%2Cthis.a.keyboardCollector))%3Aq(new%20sjcl.exception.bug(%22can\'t%20attach%20event%22))%2Cthis.q%3D!0)%7D%2CstopCollectors%3Afunction()%7Bthis.q%26%26(window.removeEventListener%3F%0A(window.removeEventListener(%22load%22%2Cthis.a.loadTimeCollector%2Cu)%2Cwindow.removeEventListener(%22mousemove%22%2Cthis.a.mouseCollector%2Cu)%2Cwindow.removeEventListener(%22keypress%22%2Cthis.a.keyboardCollector%2Cu)%2Cwindow.removeEventListener(%22devicemotion%22%2Cthis.a.accelerometerCollector%2Cu)%2Cwindow.removeEventListener(%22touchmove%22%2Cthis.a.touchCollector%2Cu))%3Adocument.detachEvent%26%26(document.detachEvent(%22onload%22%2Cthis.a.loadTimeCollector)%2Cdocument.detachEvent(%22onmousemove%22%2Cthis.a.mouseCollector)%2Cdocument.detachEvent(%22keypress%22%2C%0Athis.a.keyboardCollector))%2Cthis.q%3Du)%7D%2CaddEventListener%3Afunction(a%2Cb)%7Bthis.w%5Ba%5D%5Bthis.V%2B%2B%5D%3Db%7D%2CremoveEventListener%3Afunction(a%2Cb)%7Bvar%20c%2Cd%2Ce%3Dthis.w%5Ba%5D%2Cf%3D%5B%5D%3Bfor(d%20in%20e)e.hasOwnProperty(d)%26%26e%5Bd%5D%3D%3D%3Db%26%26f.push(d)%3Bfor(c%3D0%3Bc%3Cf.length%3Bc%2B%2B)d%3Df%5Bc%5D%2Cdelete%20e%5Bd%5D%7D%2C%24%3Afunction()%7BE(1)%7D%2Cba%3Afunction(a)%7Bvar%20b%2Cc%3Btry%7Bb%3Da.x%7C%7Ca.clientX%7C%7Ca.offsetX%7C%7C0%2Cc%3Da.y%7C%7Ca.clientY%7C%7Ca.offsetY%7C%7C0%7Dcatch(d)%7Bc%3Db%3D0%7D0!%3Db%26%260!%3Dc%26%26sjcl.random.addEntropy(%5Bb%2Cc%5D%2C2%2C%22mouse%22)%3BE(0)%7D%2Cda%3Afunction(a)%7Ba%3Da.touches%5B0%5D%7C%7Ca.changedTouches%5B0%5D%3Bsjcl.random.addEntropy(%5Ba.pageX%7C%7C%0Aa.clientX%2Ca.pageY%7C%7Ca.clientY%5D%2C1%2C%22touch%22)%3BE(0)%7D%2Caa%3Afunction()%7BE(2)%7D%2CU%3Afunction(a)%7Ba%3Da.accelerationIncludingGravity.x%7C%7Ca.accelerationIncludingGravity.y%7C%7Ca.accelerationIncludingGravity.z%3Bif(window.orientation)%7Bvar%20b%3Dwindow.orientation%3B%22number%22%3D%3D%3Dtypeof%20b%26%26sjcl.random.addEntropy(b%2C1%2C%22accelerometer%22)%7Da%26%26sjcl.random.addEntropy(a%2C2%2C%22accelerometer%22)%3BE(0)%7D%7D%3Bfunction%20C(a%2Cb)%7Bvar%20c%2Cd%3Dsjcl.random.w%5Ba%5D%2Ce%3D%5B%5D%3Bfor(c%20in%20d)d.hasOwnProperty(c)%26%26e.push(d%5Bc%5D)%3Bfor(c%3D0%3Bc%3Ce.length%3Bc%2B%2B)e%5Bc%5D(b)%7D%0Afunction%20E(a)%7B%22undefined%22!%3D%3Dtypeof%20window%26%26window.performance%26%26%22function%22%3D%3D%3Dtypeof%20window.performance.now%3Fsjcl.random.addEntropy(window.performance.now()%2Ca%2C%22loadtime%22)%3Asjcl.random.addEntropy((new%20Date).valueOf()%2Ca%2C%22loadtime%22)%7Dfunction%20A(a)%7Ba.b%3DB(a).concat(B(a))%3Ba.A%3Dnew%20sjcl.cipher.aes(a.b)%7Dfunction%20B(a)%7Bfor(var%20b%3D0%3B4%3Eb%26%26!(a.f%5Bb%5D%3Da.f%5Bb%5D%2B1%7C0%2Ca.f%5Bb%5D)%3Bb%2B%2B)%3Breturn%20a.A.encrypt(a.f)%7Dfunction%20D(a%2Cb)%7Breturn%20function()%7Bb.apply(a%2Carguments)%7D%7Dsjcl.random%3Dnew%20sjcl.prng(6)%3B%0Aa%3Atry%7Bvar%20F%2CG%2CH%2CI%3Bif(I%3D%22undefined%22!%3D%3Dtypeof%20module)%7Bvar%20J%3Bif(J%3Dmodule.exports)%7Bvar%20K%3Btry%7BK%3Drequire(%22crypto%22)%7Dcatch(L)%7BK%3Dnull%7DJ%3D(G%3DK)%26%26G.randomBytes%7DI%3DJ%7Dif(I)F%3DG.randomBytes(128)%2CF%3Dnew%20Uint32Array((new%20Uint8Array(F)).buffer)%2Csjcl.random.addEntropy(F%2C1024%2C%22crypto%5B\'randomBytes\'%5D%22)%3Belse%20if(%22undefined%22!%3D%3Dtypeof%20window%26%26%22undefined%22!%3D%3Dtypeof%20Uint32Array)%7BH%3Dnew%20Uint32Array(32)%3Bif(window.crypto%26%26window.crypto.getRandomValues)window.crypto.getRandomValues(H)%3Belse%20if(window.msCrypto%26%26window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(H)%3B%0Aelse%20break%20a%3Bsjcl.random.addEntropy(H%2C1024%2C%22crypto%5B\'getRandomValues\'%5D%22)%7D%7Dcatch(M)%7B%22undefined%22!%3D%3Dtypeof%20window%26%26window.console%26%26(console.log(%22There%20was%20an%20error%20collecting%20entropy%20from%20the%20browser%3A%22)%2Cconsole.log(M))%7D%0Asjcl.json%3D%7Bdefaults%3A%7Bv%3A1%2Citer%3A1E3%2Cks%3A128%2Cts%3A64%2Cmode%3A%22ccm%22%2Cadata%3A%22%22%2Ccipher%3A%22aes%22%7D%2CY%3Afunction(a%2Cb%2Cc%2Cd)%7Bc%3Dc%7C%7C%7B%7D%3Bd%3Dd%7C%7C%7B%7D%3Bvar%20e%3Dsjcl.json%2Cf%3De.e(%7Biv%3Asjcl.random.randomWords(4%2C0)%7D%2Ce.defaults)%2Cg%3Be.e(f%2Cc)%3Bc%3Df.adata%3B%22string%22%3D%3D%3Dtypeof%20f.salt%26%26(f.salt%3Dsjcl.codec.base64.toBits(f.salt))%3B%22string%22%3D%3D%3Dtypeof%20f.iv%26%26(f.iv%3Dsjcl.codec.base64.toBits(f.iv))%3B(!sjcl.mode%5Bf.mode%5D%7C%7C!sjcl.cipher%5Bf.cipher%5D%7C%7C%22string%22%3D%3D%3Dtypeof%20a%26%26100%3E%3Df.iter%7C%7C64!%3D%3Df.ts%26%2696!%3D%3Df.ts%26%26128!%3D%3Df.ts%7C%7C128!%3D%3Df.ks%26%26192!%3D%3Df.ks%26%260x100!%3D%3Df.ks%7C%7C2%3Ef.iv.length%7C%7C4%3C%0Af.iv.length)%26%26q(new%20sjcl.exception.invalid(%22json%20encrypt%3A%20invalid%20parameters%22))%3B%22string%22%3D%3D%3Dtypeof%20a%3F(g%3Dsjcl.misc.cachedPbkdf2(a%2Cf)%2Ca%3Dg.key.slice(0%2Cf.ks%2F32)%2Cf.salt%3Dg.salt)%3Asjcl.ecc%26%26a%20instanceof%20sjcl.ecc.elGamal.publicKey%26%26(g%3Da.kem()%2Cf.kemtag%3Dg.tag%2Ca%3Dg.key.slice(0%2Cf.ks%2F32))%3B%22string%22%3D%3D%3Dtypeof%20b%26%26(b%3Dsjcl.codec.utf8String.toBits(b))%3B%22string%22%3D%3D%3Dtypeof%20c%26%26(f.adata%3Dc%3Dsjcl.codec.utf8String.toBits(c))%3Bg%3Dnew%20sjcl.cipher%5Bf.cipher%5D(a)%3Be.e(d%2Cf)%3Bd.key%3Da%3Bf.ct%3Dsjcl.mode%5Bf.mode%5D.encrypt(g%2Cb%2Cf.iv%2Cc%2Cf.ts)%3Breturn%20f%7D%2C%0Aencrypt%3Afunction(a%2Cb%2Cc%2Cd)%7Bvar%20e%3Dsjcl.json%2Cf%3De.Y.apply(e%2Carguments)%3Breturn%20e.encode(f)%7D%2CX%3Afunction(a%2Cb%2Cc%2Cd)%7Bc%3Dc%7C%7C%7B%7D%3Bd%3Dd%7C%7C%7B%7D%3Bvar%20e%3Dsjcl.json%3Bb%3De.e(e.e(e.e(%7B%7D%2Ce.defaults)%2Cb)%2Cc%2C!0)%3Bvar%20f%2Cg%3Bf%3Db.adata%3B%22string%22%3D%3D%3Dtypeof%20b.salt%26%26(b.salt%3Dsjcl.codec.base64.toBits(b.salt))%3B%22string%22%3D%3D%3Dtypeof%20b.iv%26%26(b.iv%3Dsjcl.codec.base64.toBits(b.iv))%3B(!sjcl.mode%5Bb.mode%5D%7C%7C!sjcl.cipher%5Bb.cipher%5D%7C%7C%22string%22%3D%3D%3Dtypeof%20a%26%26100%3E%3Db.iter%7C%7C64!%3D%3Db.ts%26%2696!%3D%3Db.ts%26%26128!%3D%3Db.ts%7C%7C128!%3D%3Db.ks%26%26192!%3D%3Db.ks%26%260x100!%3D%3Db.ks%7C%7C!b.iv%7C%7C2%3Eb.iv.length%7C%7C4%3Cb.iv.length)%26%26%0Aq(new%20sjcl.exception.invalid(%22json%20decrypt%3A%20invalid%20parameters%22))%3B%22string%22%3D%3D%3Dtypeof%20a%3F(g%3Dsjcl.misc.cachedPbkdf2(a%2Cb)%2Ca%3Dg.key.slice(0%2Cb.ks%2F32)%2Cb.salt%3Dg.salt)%3Asjcl.ecc%26%26a%20instanceof%20sjcl.ecc.elGamal.secretKey%26%26(a%3Da.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0%2Cb.ks%2F32))%3B%22string%22%3D%3D%3Dtypeof%20f%26%26(f%3Dsjcl.codec.utf8String.toBits(f))%3Bg%3Dnew%20sjcl.cipher%5Bb.cipher%5D(a)%3Bf%3Dsjcl.mode%5Bb.mode%5D.decrypt(g%2Cb.ct%2Cb.iv%2Cf%2Cb.ts)%3Be.e(d%2Cb)%3Bd.key%3Da%3Breturn%201%3D%3D%3Dc.raw%3Ff%3Asjcl.codec.utf8String.fromBits(f)%7D%2Cdecrypt%3Afunction(a%2Cb%2C%0Ac%2Cd)%7Bvar%20e%3Dsjcl.json%3Breturn%20e.X(a%2Ce.decode(b)%2Cc%2Cd)%7D%2Cencode%3Afunction(a)%7Bvar%20b%2Cc%3D%22%7B%22%2Cd%3D%22%22%3Bfor(b%20in%20a)if(a.hasOwnProperty(b))switch(b.match(%2F%5E%5Ba-z0-9%5D%2B%24%2Fi)%7C%7Cq(new%20sjcl.exception.invalid(%22json%20encode%3A%20invalid%20property%20name%22))%2Cc%2B%3Dd%2B\'%22\'%2Bb%2B\'%22%3A\'%2Cd%3D%22%2C%22%2Ctypeof%20a%5Bb%5D)%7Bcase%20%22number%22%3Acase%20%22boolean%22%3Ac%2B%3Da%5Bb%5D%3Bbreak%3Bcase%20%22string%22%3Ac%2B%3D\'%22\'%2Bescape(a%5Bb%5D)%2B\'%22\'%3Bbreak%3Bcase%20%22object%22%3Ac%2B%3D\'%22\'%2Bsjcl.codec.base64.fromBits(a%5Bb%5D%2C0)%2B\'%22\'%3Bbreak%3Bdefault%3Aq(new%20sjcl.exception.bug(%22json%20encode%3A%20unsupported%20type%22))%7Dreturn%20c%2B%22%7D%22%7D%2Cdecode%3Afunction(a)%7Ba%3D%0Aa.replace(%2F%5Cs%2Fg%2C%22%22)%3Ba.match(%2F%5E%5C%7B.*%5C%7D%24%2F)%7C%7Cq(new%20sjcl.exception.invalid(%22json%20decode%3A%20this%20isn\'t%20json!%22))%3Ba%3Da.replace(%2F%5E%5C%7B%7C%5C%7D%24%2Fg%2C%22%22).split(%2F%2C%2F)%3Bvar%20b%3D%7B%7D%2Cc%2Cd%3Bfor(c%3D0%3Bc%3Ca.length%3Bc%2B%2B)(d%3Da%5Bc%5D.match(%2F%5E%5Cs*(%3F%3A(%5B%22\'%5D%3F)(%5Ba-z%5D%5Ba-z0-9%5D*)%5C1)%5Cs*%3A%5Cs*(%3F%3A(-%3F%5Cd%2B)%7C%22(%5Ba-z0-9%2B%5C%2F%25*_.%40%3D%5C-%5D*)%22%7C(true%7Cfalse))%24%2Fi))%7C%7Cq(new%20sjcl.exception.invalid(%22json%20decode%3A%20this%20isn\'t%20json!%22))%2Cd%5B3%5D%3Fb%5Bd%5B2%5D%5D%3DparseInt(d%5B3%5D%2C10)%3Ad%5B4%5D%3Fb%5Bd%5B2%5D%5D%3Dd%5B2%5D.match(%2F%5E(ct%7Cadata%7Csalt%7Civ)%24%2F)%3Fsjcl.codec.base64.toBits(d%5B4%5D)%3Aunescape(d%5B4%5D)%3Ad%5B5%5D%26%26(b%5Bd%5B2%5D%5D%3D%22true%22%3D%3D%3D%0Ad%5B5%5D)%3Breturn%20b%7D%2Ce%3Afunction(a%2Cb%2Cc)%7Ba%3D%3D%3Ds%26%26(a%3D%7B%7D)%3Bif(b%3D%3D%3Ds)return%20a%3Bfor(var%20d%20in%20b)b.hasOwnProperty(d)%26%26(c%26%26(a%5Bd%5D!%3D%3Ds%26%26a%5Bd%5D!%3D%3Db%5Bd%5D)%26%26q(new%20sjcl.exception.invalid(%22required%20parameter%20overridden%22))%2Ca%5Bd%5D%3Db%5Bd%5D)%3Breturn%20a%7D%2Cfa%3Afunction(a%2Cb)%7Bvar%20c%3D%7B%7D%2Cd%3Bfor(d%20in%20a)a.hasOwnProperty(d)%26%26a%5Bd%5D!%3D%3Db%5Bd%5D%26%26(c%5Bd%5D%3Da%5Bd%5D)%3Breturn%20c%7D%2Cea%3Afunction(a%2Cb)%7Bvar%20c%3D%7B%7D%2Cd%3Bfor(d%3D0%3Bd%3Cb.length%3Bd%2B%2B)a%5Bb%5Bd%5D%5D!%3D%3Ds%26%26(c%5Bb%5Bd%5D%5D%3Da%5Bb%5Bd%5D%5D)%3Breturn%20c%7D%7D%3Bsjcl.encrypt%3Dsjcl.json.encrypt%3Bsjcl.decrypt%3Dsjcl.json.decrypt%3Bsjcl.misc.ca%3D%7B%7D%3B%0Asjcl.misc.cachedPbkdf2%3Dfunction(a%2Cb)%7Bvar%20c%3Dsjcl.misc.ca%2Cd%3Bb%3Db%7C%7C%7B%7D%3Bd%3Db.iter%7C%7C1E3%3Bc%3Dc%5Ba%5D%3Dc%5Ba%5D%7C%7C%7B%7D%3Bd%3Dc%5Bd%5D%3Dc%5Bd%5D%7C%7C%7BfirstSalt%3Ab.salt%26%26b.salt.length%3Fb.salt.slice(0)%3Asjcl.random.randomWords(2%2C0)%7D%3Bc%3Db.salt%3D%3D%3Ds%3Fd.firstSalt%3Ab.salt%3Bd%5Bc%5D%3Dd%5Bc%5D%7C%7Csjcl.misc.pbkdf2(a%2Cc%2Cb.iter)%3Breturn%7Bkey%3Ad%5Bc%5D.slice(0)%2Csalt%3Ac.slice(0)%7D%7D%3B%0A%3C%2Fscript%3E%0A%09%3Cscript%3E%0Avar%20encrypted%20%3D%20\'%7B%7Bencrypted-text%7D%7D\'%0Aif%20(encrypted.length%20%3D%3D%3D%200%20%7C%7C%20encrypted.substring(2%2C%2016)%20%3D%3D%3D%20\'encrypted-text\')%0A%09showError(form.submit%2C%20\'An%20error%20occured.\')%0A%09%3C%2Fscript%3E%0A%09%3Cscript%3E%0Avar%20form%20%3D%20%7B%0A%09password%3A%20document.getElementById(\'password\')%2C%0A%09submit%3A%20document.getElementById(\'submit\')%2C%0A%09message%3A%20document.getElementById(\'message\')%0A%7D%0Avar%20hint%20%3D%20document.getElementById(\'hint\')%0A%0Avar%20resetForm%20%3D%20function%20()%20%7B%0A%09form.password.classList.remove(\'error\')%0A%09form.submit.classList.remove(\'error\')%0A%09hint.style.display%20%3D%20\'none\'%0A%7D%0Avar%20showError%20%3D%20function%20(element%2C%20message)%20%7B%0A%09element.classList.add(\'error\')%0A%09hint.innerHTML%20%3D%20message%0A%09hint.style.display%20%3D%20\'block\'%0A%7D%0A%0Aform.submit.addEventListener(\'click\'%2C%20function%20()%20%7B%0A%09resetForm()%0A%0A%09if%20(form.password.value.length%20%3D%3D%3D%200)%0A%09%09return%20showError(form.password%2C%20\'Please%20enter%20a%20password.\')%0A%0A%09try%20%7B%20decrypted%20%3D%20sjcl.decrypt(form.password.value%2C%20encrypted)%20%7D%0A%09catch%20(error)%20%7B%20return%20showError(form.submit%2C%20\'The%20password%20seems%20to%20be%20wrong.\')%20%7D%0A%0A%09form.message.innerHTML%20%3D%20decrypted%0A%09form.password.value%20%3D%20\'\'%0A%7D%2C%20false)%0A%09%3C%2Fscript%3E%0A%3C%2Fbody%3E%0A%3C%2Fhtml%3E%0A'
if (bundle.length === 0 || bundle.substring(2, 16) === 'bundle-html')
	showError(form.submit, 'An error occured.')
bundle = decodeURIComponent(bundle)
	</script>
	<script>
var form = {
	message: document.getElementById('message'),
	password: document.getElementById('password'),
	submit: document.getElementById('submit')
}
var hint = document.getElementById('hint')

var resetForm = function () {
	form.message.classList.remove('error')
	form.password.classList.remove('error')
	form.submit.classList.remove('error')
	hint.style.display = 'none'
}
var showError = function (element, message) {
	element.classList.add('error')
	hint.innerHTML = message
	hint.style.display = 'block'
}

form.submit.addEventListener('click', function () {
	resetForm()

	if (form.message.value.length === 0)
		return showError(form.message, 'Please enter a message.')
	if (form.password.value.length === 0)
		return showError(form.password, 'Please enter a password.')

	try { encrypted = sjcl.encrypt(form.password.value, form.message.value) }
	catch (error) { return showError(form.submit, 'An error occured.') }

	html = bundle.replace('{{encrypted-text}}', encrypted)
	download(html, 'secret.html', 'text/html')
	form.password.value = ''
}, false)
	</script>
</body>
</html>
