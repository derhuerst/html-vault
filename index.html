<!DOCTYPE HTML>

<html>
<head>
	<meta charset="utf-8">
	<title>html-vault</title>
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta name="description" content="Store a secret securely in a file.">
	<meta name="keywords" content="secret, encrypt, decrypt, aes, html, share">
	<meta name="author" content="Jannis R">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<style>
body {
	margin: 0 auto; padding: 0 1em; max-width: 28em;
	font-size: 110%; font-family: "Helvetica Neue", sans-serif;
}
p { color: #333; line-height: 1.3; }
a { color: #2980b9; text-decoration: none; }
input, button, textarea {
	display: block; margin: 1em 0; box-sizing: border-box; width: 100%;
	font-size: 100%;
}
input, textarea { padding: .4em; border: 1px solid #888; border-radius: .2em; }
input.error, textarea.error { border-color: #c0392b; }
button {
	padding: .4em;
	border: none; border-radius: .2em;
	color: white; background-color: #2980b9;
	cursor: pointer;
}
button:active { background-color: #1970a9; }
button.error { background-color: #c0392b; }
textarea { min-height: 7em; font-family: "Helvetica Neue", sans-serif; }

#hint {
	display: none;
	padding: .4em .5em; border-radius: .2em;
	color: white; background-color: #c0392b;
}
#notes { margin-top: 3em; color: #555; font-size: 90%; }
#notes::before { content: "*"; padding-right: .3em; }

#github { margin-top: 3em; text-align: center; }
#github path { fill: #aaa; }
	</style>
</head>
<body>
	<p>Using this service, you can generate a file that contains a secret. The secret can only be obtained using the password that you provided.</p>
	<p id="hint"></p>
	<textarea id="message" placeholder="Enter your secret message." name="message"></textarea>
	<input type="password" id="password" placeholder="Pick a password that is long and hard-to-guess."/>
	<p>Once you have saved the file, send it using whatever tool you want. Remember to transmit the password separately.<a href="#notes">*</a></p>
	<button id="submit">Encrypt my secret</button>
	<p id="notes">The encryption is only as secure as the weakest link in the chain. Don't send the file and password over the same channel. If you're serious about security, don't send the password at all, but give it to the receiver manually.</p>
	<!-- https://github.com/github/octicons/blob/0640e0c0e555a02e4628b96d5e72ef3328f27214/svg/mark-github.svg -->
	<p id="github"><a href="https://github.com/derhuerst/html-vault"><svg height="32" width="32" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59 0.4 0.07 0.55-0.17 0.55-0.38 0-0.19-0.01-0.82-0.01-1.49-2.01 0.37-2.53-0.49-2.69-0.94-0.09-0.23-0.48-0.94-0.82-1.13-0.28-0.15-0.68-0.52-0.01-0.53 0.63-0.01 1.08 0.58 1.23 0.82 0.72 1.21 1.87 0.87 2.33 0.66 0.07-0.52 0.28-0.87 0.51-1.07-1.78-0.2-3.64-0.89-3.64-3.95 0-0.87 0.31-1.59 0.82-2.15-0.08-0.2-0.36-1.02 0.08-2.12 0 0 0.67-0.21 2.2 0.82 0.64-0.18 1.32-0.27 2-0.27 0.68 0 1.36 0.09 2 0.27 1.53-1.04 2.2-0.82 2.2-0.82 0.44 1.1 0.16 1.92 0.08 2.12 0.51 0.56 0.82 1.27 0.82 2.15 0 3.07-1.87 3.75-3.65 3.95 0.29 0.25 0.54 0.73 0.54 1.48 0 1.07-0.01 1.93-0.01 2.2 0 0.21 0.15 0.46 0.55 0.38C13.71 14.53 16 11.53 16 8 16 3.58 12.42 0 8 0z"/></svg></a></p>
	<script>//download.js v4.2, by dandavis; 2008-2017. [MIT] see http://danml.com/download.html for tests/usage
;(function(r,l){"function"==typeof define&&define.amd?define([],l):"object"==typeof exports?module.exports=l():r.download=l()})(this,function(){return function l(a,e,k){function q(a){var h=a.split(/[:;,]/);a=h[1];var h=("base64"==h[2]?atob:decodeURIComponent)(h.pop()),d=h.length,b=0,c=new Uint8Array(d);for(b;b<d;++b)c[b]=h.charCodeAt(b);return new f([c],{type:a})}function m(a,b){if("download"in d)return d.href=a,d.setAttribute("download",n),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout(function(){d.click(),document.body.removeChild(d),!0===b&&setTimeout(function(){g.URL.revokeObjectURL(d.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(a)&&(a="data:"+a.replace(/^data:([\w\/\-\+]+)/,"application/octet-stream")),!window.open(a)&&confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=a),!0;var c=document.createElement("iframe");document.body.appendChild(c),!b&&/^data:/.test(a)&&(a="data:"+a.replace(/^data:([\w\/\-\+]+)/,"application/octet-stream")),c.src=a,setTimeout(function(){document.body.removeChild(c)},333)}var g=window,b=k||"application/octet-stream",c=!e&&!k&&a,d=document.createElement("a");k=function(a){return String(a)};var f=g.Blob||g.MozBlob||g.WebKitBlob||k,n=e||"download",f=f.call?f.bind(g):Blob;"true"===String(this)&&(a=[a,b],b=a[0],a=a[1]);if(c&&2048>c.length&&(n=c.split("/").pop().split("?")[0],d.href=c,-1!==d.href.indexOf(c))){var p=new XMLHttpRequest;return p.open("GET",c,!0),p.responseType="blob",p.onload=function(a){l(a.target.response,n,"application/octet-stream")},setTimeout(function(){p.send()},0),p}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(a)){if(!(2096103.424<a.length&&f!==k))return navigator.msSaveBlob?navigator.msSaveBlob(q(a),n):m(a);a=q(a),b=a.type||"application/octet-stream"}else if(/([\x80-\xff])/.test(a)){e=0;var c=new Uint8Array(a.length),t=c.length;for(e;e<t;++e)c[e]=a.charCodeAt(e);a=new f([c],{type:b})}a=a instanceof f?a:new f([a],{type:b});if(navigator.msSaveBlob)return navigator.msSaveBlob(a,n);if(g.URL)m(g.URL.createObjectURL(a),!0);else{if("string"==typeof a||a.constructor===k)try{return m("data:"+b+";base64,"+g.btoa(a))}catch(h){return m("data:"+b+","+encodeURIComponent(a))}b=new FileReader,b.onload=function(a){m(this.result)},b.readAsDataURL(a)}return!0}});
</script>
	<script>"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};
sjcl.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c,d,e,f=this.s[0][4],g=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.b=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d[a]=d[a-b]^c}for(b=0;a;b++,a--)c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&
255]]};
sjcl.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c=a[4],d=b[4],e,f,g,h=[],k=[],l,n,m,p;for(e=0;0x100>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=l||1,g=k[g]||1)for(m=g^g<<1^g<<2^g<<3^g<<4,m=m>>8^m&255^99,c[f]=m,d[m]=f,n=h[e=h[l=h[f]]],p=0x1010101*n^0x10001*e^0x101*l^0x1010100*f,n=0x101*h[m]^0x1010100*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p=p<<24^p>>>8;for(e=
0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};
function t(a,b,c){if(4!==b.length)throw new sjcl.exception.invalid("invalid aes block size");var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,k,l,n=d.length/4-2,m,p=4,r=[0,0,0,0];h=a.s[c];a=h[0];var q=h[1],v=h[2],w=h[3],x=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q[f>>16&255]^v[g>>8&255]^w[b&255]^d[p],k=a[f>>>24]^q[g>>16&255]^v[b>>8&255]^w[e&255]^d[p+1],l=a[g>>>24]^q[b>>16&255]^v[e>>8&255]^w[f&255]^d[p+2],b=a[b>>>24]^q[e>>16&255]^v[f>>8&255]^w[g&255]^d[p+3],p+=4,e=h,f=k,g=l;for(m=
0;4>m;m++)r[c?3&-m:m]=x[e>>>24]<<24^x[f>>16&255]<<16^x[g>>8&255]<<8^x[b&255]^d[p++],h=e,e=f,f=g,g=b,b=h;return r}
sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.$(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===
b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+0x10000000000*a},getPartial:function(a){return Math.round(a/0x10000000000)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return!1;var c=0,d;for(d=0;d<a.length;d++)c|=a[d]^b[d];return 0===
c},$:function(a,b,c,d){var e;e=0;for(void 0===d&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&0xff00|(c&0xff00)<<8|c<<24;return a}};
sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++)0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++)d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};
sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d;a=a.replace(/\s|0x/g,"");d=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,4*d)}};
sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c){var d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f="",g=0,h=sjcl.codec.base32.B,k=0,l=sjcl.bitArray.bitLength(a);c&&(h=sjcl.codec.base32.X);for(c=0;f.length*d<l;)f+=h.charAt((k^a[c]>>>g)>>>e),g<d?(k=a[c]<<d-g,g+=e,c++):(k<<=d,g-=d);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\s|=/g,"").toUpperCase();var c=sjcl.codec.base32.BITS,
d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f=[],g,h=0,k=sjcl.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl.codec.base32.X,m="base32hex");for(g=0;g<a.length;g++){n=k.indexOf(a.charAt(g));if(0>n){if(!b)try{return sjcl.codec.base32hex.toBits(a)}catch(p){}throw new sjcl.exception.invalid("this isn't "+m+"!");}h>e?(h-=e,f.push(l^n>>>h),l=n<<c-h):(h+=d,l^=n<<c-h)}h&56&&f.push(sjcl.bitArray.partial(h&56,l,1));return f}};
sjcl.codec.base32hex={fromBits:function(a,b){return sjcl.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl.codec.base32.toBits(a,1)}};
sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.B,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d.length&3&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\s|=/g,"");var c=[],d,e=0,f=sjcl.codec.base64.B,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d=0;d<a.length;d++){h=f.indexOf(a.charAt(d));
if(0>h)throw new sjcl.exception.invalid("this isn't base64!");26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256).update(a).finalize()};
sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.A=sjcl.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl.bitArray.bitLength(a);if(0x1fffffffffffff<a)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d=new Uint32Array(c),e=0;for(b=512+b-(512+b&0x1ff);b<=a;b+=512)u(this,d.subarray(16*e,
16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&0x1ff);b<=a;b+=512)u(this,c.splice(0,16));return this},finalize:function(){var a,b=this.A,c=this.F,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/0x100000000));for(b.push(this.l|0);b.length;)u(this,b.splice(0,16));this.reset();return c},Y:[],b:[],O:function(){function a(a){return 0x100000000*(a-Math.floor(a))|0}for(var b=0,c=2,d,e;64>b;c++){e=!0;for(d=2;d*d<=c;d++)if(0===c%d){e=
!1;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};
function u(a,b){var c,d,e,f=a.F,g=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p=f[5],r=f[6],q=f[7];for(c=0;64>c;c++)16>c?d=b[c]:(d=b[c+1&15],e=b[c+14&15],d=b[c&15]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d=d+q+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p^r))+g[c],q=r,r=p,p=m,m=n+d|0,n=l,l=k,k=h,h=d+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p|0;f[6]=f[6]+r|0;f[7]=
f[7]+q|0}
sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl.mode.ccm.G.indexOf(a);-1<a&&sjcl.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl.mode.ccm.G.slice(),c;for(c=0;c<b.length;c+=1)b[c](a)},encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,k=h.bitLength(c)/8,l=h.bitLength(g)/8;e=e||64;d=d||[];if(7>k)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c=h.clamp(c,
8*(15-f));b=sjcl.mode.ccm.V(a,b,c,d,e,f);g=sjcl.mode.ccm.C(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));k=sjcl.mode.ccm.C(a,k,c,l,e,b);a=sjcl.mode.ccm.V(a,k.data,c,d,e,b);if(!f.equal(k.tag,a))throw new sjcl.exception.corrupt("ccm: tag doesn't match");
return k.data},na:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,k=h.i;d=[h.partial(8,(b.length?64:0)|d-2<<2|f-1)];d=h.concat(d,c);d[3]|=e;d=a.encrypt(d);if(b.length)for(c=h.bitLength(b)/8,65279>=c?g=[h.partial(16,c)]:0xffffffff>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,b),b=0;b<g.length;b+=4)d=a.encrypt(k(d,g.slice(b,b+4).concat([0,0,0])));return d},V:function(a,b,c,d,e,f){var g=sjcl.bitArray,h=g.i;e/=8;if(e%2||4>e||16<e)throw new sjcl.exception.invalid("ccm: invalid tag length");
if(0xffffffff<d.length||0xffffffff<b.length)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");c=sjcl.mode.ccm.na(a,d,c,e,g.bitLength(b)/8,f);for(d=0;d<b.length;d+=4)c=a.encrypt(h(c,b.slice(d,d+4).concat([0,0,0])));return g.clamp(c,8*e)},C:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!k)return{tag:d,data:[]};for(g=0;g<k;g+=4)g>n&&(sjcl.mode.ccm.fa(g/
k),n+=m),c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d,data:h.clamp(b,l)}}};
sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl.mode.ocb2.S,k=sjcl.bitArray,l=k.i,n=[0,0,0,0];c=h(a.encrypt(c));var m,p=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=l(n,m),p=p.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g),b);n=l(n,l(m.concat([0,0,0]),g));n=a.encrypt(l(n,l(c,h(c))));
d.length&&(n=l(n,f?d:sjcl.mode.ocb2.pmac(a,d)));return p.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl.mode.ocb2.S,h=sjcl.bitArray,k=h.i,l=[0,0,0,0],n=g(a.encrypt(c)),m,p,r=sjcl.bitArray.bitLength(b)-e,q=[];d=d||[];for(c=0;c+4<r/32;c+=4)m=k(n,a.decrypt(k(n,b.slice(c,c+4)))),l=k(l,m),q=q.concat(m),n=g(n);p=r-32*c;m=a.encrypt(k(n,[0,0,0,p]));m=k(m,h.clamp(b.slice(c),p).concat([0,
0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d.length&&(l=k(l,f?d:sjcl.mode.ocb2.pmac(a,d)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl.exception.corrupt("ocb: tag doesn't match");return q.concat(h.clamp(m,p))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.S,e=sjcl.bitArray,f=e.i,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);
return a.encrypt(f(d(f(h,d(h))),g))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};
sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);b=sjcl.bitArray;d=d||[];a=sjcl.mode.gcm.C(!0,a,f,d,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d=d||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.C(!1,a,f,d,c,e);if(!g.equal(a.tag,b))throw new sjcl.exception.corrupt("gcm: tag doesn't match");return a.data},ka:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.i;e=[0,0,
0,0];f=b.slice(0);for(c=0;128>c;c++){(d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d=3;0<d;d--)f[d]=f[d]>>>1|(f[d-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-0x1f000000)}return e},j:function(a,b,c){var d,e=c.length;b=b.slice(0);for(d=0;d<e;d+=4)b[0]^=0xffffffff&c[d],b[1]^=0xffffffff&c[d+1],b[2]^=0xffffffff&c[d+2],b[3]^=0xffffffff&c[d+3],b=sjcl.mode.gcm.ka(b,a);return b},C:function(a,b,c,d,e,f){var g,h,k,l,n,m,p,r,q=sjcl.bitArray;m=c.length;p=q.bitLength(c);r=q.bitLength(d);h=q.bitLength(e);
g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q.concat(e,[1])):(e=sjcl.mode.gcm.j(g,[0,0,0,0],e),e=sjcl.mode.gcm.j(g,e,[0,0,Math.floor(h/0x100000000),h&0xffffffff]));h=sjcl.mode.gcm.j(g,[0,0,0,0],d);n=e.slice(0);d=h.slice(0);a||(d=sjcl.mode.gcm.j(g,h,c));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c[l]^=k[0],c[l+1]^=k[1],c[l+2]^=k[2],c[l+3]^=k[3];c=q.clamp(c,p);a&&(d=sjcl.mode.gcm.j(g,h,c));a=[Math.floor(r/0x100000000),r&0xffffffff,Math.floor(p/0x100000000),p&0xffffffff];d=sjcl.mode.gcm.j(g,d,a);k=b.encrypt(e);
d[0]^=k[0];d[1]^=k[1];d[2]^=k[2];d[3]^=k[3];return{tag:q.bitSlice(d,0,f),data:c}}};sjcl.misc.hmac=function(a,b){this.W=b=b||sjcl.hash.sha256;var c=[[],[]],d,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d=0;d<e;d++)c[0][d]=a[d]^909522486,c[1][d]=a[d]^1549556828;this.w[0].update(c[0]);this.w[1].update(c[1]);this.R=new b(this.w[0])};
sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=!1};sjcl.misc.hmac.prototype.update=function(a){this.aa=!0;this.R.update(a)};sjcl.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=(new this.W(this.w[1])).update(a).finalize();this.reset();return a};
sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1E4;if(0>d||0>c)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,k,l=[],n=sjcl.bitArray;for(k=1;32*l.length<(d||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g=1;g<c;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d&&(l=n.clamp(l,d));return l};
sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=!1;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=0x10000;this.T=[0,48,64,96,128,192,0x100,384,512,768,1024];this.da=3E4;this.ba=80};
sjcl.prng.prototype={randomWords:function(a,b){var c=[],d;d=this.isReady(b);var e;if(d===this.u)throw new sjcl.exception.notReady("generator isn't seeded");if(d&this.J){d=!(d&this.I);e=[];var f=0,g;this.Z=e[0]=(new Date).valueOf()+this.da;for(g=0;16>g;g++)e.push(0x100000000*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.m[g],this.m[g]=0,d||!(this.P&1<<g));g++);this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=
f);this.P++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.L=new sjcl.cipher.aes(this.b);for(d=0;4>d&&(this.h[d]=this.h[d]+1|0,!this.h[d]);d++);}for(d=0;d<a;d+=4)0===(d+1)%this.ca&&y(this),e=z(this),c.push(e[0],e[1],e[2],e[3]);y(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,
b,c){c=c||"user";var d,e,f=(new Date).valueOf(),g=this.H[c],h=this.isReady(),k=0;d=this.U[c];void 0===d&&(d=this.U[c]=this.ha++);void 0===g&&(g=this.H[c]=0);this.H[c]=(this.H[c]+1)%this.c.length;switch(typeof a){case "number":void 0===b&&(b=1);this.c[g].update([d,this.N++,1,b,f,1,a|0]);break;case "object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(k=1),c=0;c<a.length&&!k;c++)"number"!==typeof a[c]&&
(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d,this.N++,2,b,f,a.length].concat(a))}break;case "string":void 0===b&&(b=a.length);this.c[g].update([d,this.N++,3,b,f,a.length]);this.c[g].update(a);break;default:k=1}if(k)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},
isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&(new Date).valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener)window.addEventListener("load",
this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl.exception.bug("can't attach event");
this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",
this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c,d,e=this.K[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},la:function(){C(this,1)},oa:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C(this,0)},qa:function(a){a=
a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C(this,0)}};
function A(a,b){var c,d=sjcl.random.K[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function C(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy((new Date).valueOf(),b,"loadtime")}function y(a){a.b=z(a).concat(z(a));a.L=new sjcl.cipher.aes(a.b)}function z(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}
function B(a,b){return function(){b.apply(a,arguments)}}sjcl.random=new sjcl.prng(6);
a:try{var D,E,F,G;if(G="undefined"!==typeof module&&module.exports){var H;try{H=require("crypto")}catch(a){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array((new Uint8Array(D)).buffer),sjcl.random.addEntropy(D,1024,"crypto['randomBytes']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F);
else break a;sjcl.random.addEntropy(F,1024,"crypto['getRandomValues']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}
sjcl.json={defaults:{v:1,iter:1E4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.g({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.g(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));if(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&0x100!==f.ks||2>f.iv.length||
4<f.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.g(d,f);d.key=a;f.ct="ccm"===f.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&
b instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},encrypt:function(a,b,c,d){var e=sjcl.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.g(e.g(e.g({},e.defaults),b),c,!0);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));if(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===
typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&0x100!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl.codec.utf8String.toBits(f));g=new sjcl.cipher[b.cipher](a);f="ccm"===
b.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d,b);d.key=a;return 1===c.raw?f:sjcl.codec.utf8String.fromBits(f)},decrypt:function(a,b,c,d){var e=sjcl.json;return e.ia(a,e.decode(b),c,d)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");c+=d+'"'+
b+'":';d=",";switch(typeof a[b]){case "number":case "boolean":c+=a[b];break;case "string":c+='"'+escape(a[b])+'"';break;case "object":c+='"'+sjcl.codec.base64.fromBits(a[b],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type");}}return c+"}"},decode:function(a){a=a.replace(/\s/g,"");if(!a.match(/^\{.*\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");a=a.replace(/^\{|\}$/g,"").split(/,/);var b={},c,d;for(c=0;c<a.length;c++){if(!(d=a[c].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");
null!=d[3]?b[d[2]]=parseInt(d[3],10):null!=d[4]?b[d[2]]=d[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(d[4]):unescape(d[4]):null!=d[5]&&(b[d[2]]="true"===d[5])}return b},g:function(a,b,c){void 0===a&&(a={});if(void 0===b)return a;for(var d in b)if(b.hasOwnProperty(d)){if(c&&void 0!==a[d]&&a[d]!==b[d])throw new sjcl.exception.invalid("required parameter overridden");a[d]=b[d]}return a},sa:function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&a[d]!==b[d]&&(c[d]=a[d]);return c},ra:function(a,
b){var c={},d;for(d=0;d<b.length;d++)void 0!==a[b[d]]&&(c[b[d]]=a[b[d]]);return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.pa={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.pa,d;b=b||{};d=b.iter||1E3;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=void 0===b.salt?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d[c].slice(0),salt:c.slice(0)}};
"undefined"!==typeof module&&module.exports&&(module.exports=sjcl);"function"===typeof define&&define([],function(){return sjcl});
</script>
	<script>
var bundle = '%3C!DOCTYPE%20HTML%3E%0A%0A%3Chtml%3E%0A%3Chead%3E%0A%09%3Ctitle%3Esecret%3C%2Ftitle%3E%0A%09%3Cmeta%20charset%3D%22utf-8%22%3E%0A%09%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice-width%2Cinitial-scale%3D1%22%3E%0A%09%3Cstyle%3E%0Abody%20%7B%0A%09margin%3A%200%20auto%3B%20padding%3A%200%201em%3B%20max-width%3A%2028em%3B%0A%09font-size%3A%20110%25%3B%20font-family%3A%20%22Helvetica%20Neue%22%2C%20sans-serif%3B%0A%7D%0Ap%20%7B%20color%3A%20%23333%3B%20line-height%3A%201.3%3B%20%7D%0Aa%20%7B%20color%3A%20%232980b9%3B%20text-decoration%3A%20none%3B%20%7D%0Ainput%2C%20button%2C%20textarea%20%7B%0A%09display%3A%20block%3B%20margin%3A%201em%200%3B%20box-sizing%3A%20border-box%3B%20width%3A%20100%25%3B%0A%09font-size%3A%20100%25%3B%0A%7D%0Ainput%2C%20textarea%20%7B%20padding%3A%20.4em%3B%20border%3A%201px%20solid%20%23888%3B%20border-radius%3A%20.2em%3B%20%7D%0Ainput.error%2C%20textarea.error%20%7B%20border-color%3A%20%23c0392b%3B%20%7D%0Abutton%20%7B%0A%09padding%3A%20.4em%3B%0A%09border%3A%20none%3B%20border-radius%3A%20.2em%3B%0A%09color%3A%20white%3B%20background-color%3A%20%232980b9%3B%0A%09cursor%3A%20pointer%3B%0A%7D%0Abutton%3Aactive%20%7B%20background-color%3A%20%231970a9%3B%20%7D%0Abutton.error%20%7B%20background-color%3A%20%23c0392b%3B%20%7D%0Atextarea%20%7B%20min-height%3A%207em%3B%20font-family%3A%20%22Helvetica%20Neue%22%2C%20sans-serif%3B%20%7D%0Apre%20%7B%0A%09padding%3A%20.6em%3B%0A%09color%3A%20%23333%3B%20background-color%3A%20%23eee%3B%0A%09border-radius%3A%20.2em%3B%0A%09word-wrap%3A%20auto%3B%20white-space%3A%20pre-wrap%3B%0A%7D%0A%0A%23hint%20%7B%0A%09display%3A%20none%3B%0A%09padding%3A%20.4em%20.5em%3B%20border-radius%3A%20.2em%3B%0A%09color%3A%20white%3B%20background-color%3A%20%23c0392b%3B%0A%7D%0A%09%3C%2Fstyle%3E%0A%3C%2Fhead%3E%0A%3Cbody%3E%0A%09%3Cp%3EThis%20file%20contains%20an%20encrypted%20message.%3C%2Fp%3E%0A%09%3Cp%20id%3D%22hint%22%3E%3C%2Fp%3E%0A%09%3Cinput%20type%3D%22password%22%20id%3D%22password%22%20placeholder%3D%22Enter%20the%20password.%22%2F%3E%0A%09%3Cbutton%20id%3D%22submit%22%3EDecrypt%20the%20secret%3C%2Fbutton%3E%0A%09%3Cpre%20id%3D%22message%22%3E%3C%2Fpre%3E%0A%09%3Cscript%3E%22use%20strict%22%3Bvar%20sjcl%3D%7Bcipher%3A%7B%7D%2Chash%3A%7B%7D%2Ckeyexchange%3A%7B%7D%2Cmode%3A%7B%7D%2Cmisc%3A%7B%7D%2Ccodec%3A%7B%7D%2Cexception%3A%7Bcorrupt%3Afunction(a)%7Bthis.toString%3Dfunction()%7Breturn%22CORRUPT%3A%20%22%2Bthis.message%7D%3Bthis.message%3Da%7D%2Cinvalid%3Afunction(a)%7Bthis.toString%3Dfunction()%7Breturn%22INVALID%3A%20%22%2Bthis.message%7D%3Bthis.message%3Da%7D%2Cbug%3Afunction(a)%7Bthis.toString%3Dfunction()%7Breturn%22BUG%3A%20%22%2Bthis.message%7D%3Bthis.message%3Da%7D%2CnotReady%3Afunction(a)%7Bthis.toString%3Dfunction()%7Breturn%22NOT%20READY%3A%20%22%2Bthis.message%7D%3Bthis.message%3Da%7D%7D%7D%3B%0Asjcl.cipher.aes%3Dfunction(a)%7Bthis.s%5B0%5D%5B0%5D%5B0%5D%7C%7Cthis.O()%3Bvar%20b%2Cc%2Cd%2Ce%2Cf%3Dthis.s%5B0%5D%5B4%5D%2Cg%3Dthis.s%5B1%5D%3Bb%3Da.length%3Bvar%20h%3D1%3Bif(4!%3D%3Db%26%266!%3D%3Db%26%268!%3D%3Db)throw%20new%20sjcl.exception.invalid(%22invalid%20aes%20key%20size%22)%3Bthis.b%3D%5Bd%3Da.slice(0)%2Ce%3D%5B%5D%5D%3Bfor(a%3Db%3Ba%3C4*b%2B28%3Ba%2B%2B)%7Bc%3Dd%5Ba-1%5D%3Bif(0%3D%3D%3Da%25b%7C%7C8%3D%3D%3Db%26%264%3D%3D%3Da%25b)c%3Df%5Bc%3E%3E%3E24%5D%3C%3C24%5Ef%5Bc%3E%3E16%26255%5D%3C%3C16%5Ef%5Bc%3E%3E8%26255%5D%3C%3C8%5Ef%5Bc%26255%5D%2C0%3D%3D%3Da%25b%26%26(c%3Dc%3C%3C8%5Ec%3E%3E%3E24%5Eh%3C%3C24%2Ch%3Dh%3C%3C1%5E283*(h%3E%3E7))%3Bd%5Ba%5D%3Dd%5Ba-b%5D%5Ec%7Dfor(b%3D0%3Ba%3Bb%2B%2B%2Ca--)c%3Dd%5Bb%263%3Fa%3Aa-4%5D%2Ce%5Bb%5D%3D4%3E%3Da%7C%7C4%3Eb%3Fc%3Ag%5B0%5D%5Bf%5Bc%3E%3E%3E24%5D%5D%5Eg%5B1%5D%5Bf%5Bc%3E%3E16%26255%5D%5D%5Eg%5B2%5D%5Bf%5Bc%3E%3E8%26255%5D%5D%5Eg%5B3%5D%5Bf%5Bc%26%0A255%5D%5D%7D%3B%0Asjcl.cipher.aes.prototype%3D%7Bencrypt%3Afunction(a)%7Breturn%20t(this%2Ca%2C0)%7D%2Cdecrypt%3Afunction(a)%7Breturn%20t(this%2Ca%2C1)%7D%2Cs%3A%5B%5B%5B%5D%2C%5B%5D%2C%5B%5D%2C%5B%5D%2C%5B%5D%5D%2C%5B%5B%5D%2C%5B%5D%2C%5B%5D%2C%5B%5D%2C%5B%5D%5D%5D%2CO%3Afunction()%7Bvar%20a%3Dthis.s%5B0%5D%2Cb%3Dthis.s%5B1%5D%2Cc%3Da%5B4%5D%2Cd%3Db%5B4%5D%2Ce%2Cf%2Cg%2Ch%3D%5B%5D%2Ck%3D%5B%5D%2Cl%2Cn%2Cm%2Cp%3Bfor(e%3D0%3B0x100%3Ee%3Be%2B%2B)k%5B(h%5Be%5D%3De%3C%3C1%5E283*(e%3E%3E7))%5Ee%5D%3De%3Bfor(f%3Dg%3D0%3B!c%5Bf%5D%3Bf%5E%3Dl%7C%7C1%2Cg%3Dk%5Bg%5D%7C%7C1)for(m%3Dg%5Eg%3C%3C1%5Eg%3C%3C2%5Eg%3C%3C3%5Eg%3C%3C4%2Cm%3Dm%3E%3E8%5Em%26255%5E99%2Cc%5Bf%5D%3Dm%2Cd%5Bm%5D%3Df%2Cn%3Dh%5Be%3Dh%5Bl%3Dh%5Bf%5D%5D%5D%2Cp%3D0x1010101*n%5E0x10001*e%5E0x101*l%5E0x1010100*f%2Cn%3D0x101*h%5Bm%5D%5E0x1010100*m%2Ce%3D0%3B4%3Ee%3Be%2B%2B)a%5Be%5D%5Bf%5D%3Dn%3Dn%3C%3C24%5En%3E%3E%3E8%2Cb%5Be%5D%5Bm%5D%3Dp%3Dp%3C%3C24%5Ep%3E%3E%3E8%3Bfor(e%3D%0A0%3B5%3Ee%3Be%2B%2B)a%5Be%5D%3Da%5Be%5D.slice(0)%2Cb%5Be%5D%3Db%5Be%5D.slice(0)%7D%7D%3B%0Afunction%20t(a%2Cb%2Cc)%7Bif(4!%3D%3Db.length)throw%20new%20sjcl.exception.invalid(%22invalid%20aes%20block%20size%22)%3Bvar%20d%3Da.b%5Bc%5D%2Ce%3Db%5B0%5D%5Ed%5B0%5D%2Cf%3Db%5Bc%3F3%3A1%5D%5Ed%5B1%5D%2Cg%3Db%5B2%5D%5Ed%5B2%5D%3Bb%3Db%5Bc%3F1%3A3%5D%5Ed%5B3%5D%3Bvar%20h%2Ck%2Cl%2Cn%3Dd.length%2F4-2%2Cm%2Cp%3D4%2Cr%3D%5B0%2C0%2C0%2C0%5D%3Bh%3Da.s%5Bc%5D%3Ba%3Dh%5B0%5D%3Bvar%20q%3Dh%5B1%5D%2Cv%3Dh%5B2%5D%2Cw%3Dh%5B3%5D%2Cx%3Dh%5B4%5D%3Bfor(m%3D0%3Bm%3Cn%3Bm%2B%2B)h%3Da%5Be%3E%3E%3E24%5D%5Eq%5Bf%3E%3E16%26255%5D%5Ev%5Bg%3E%3E8%26255%5D%5Ew%5Bb%26255%5D%5Ed%5Bp%5D%2Ck%3Da%5Bf%3E%3E%3E24%5D%5Eq%5Bg%3E%3E16%26255%5D%5Ev%5Bb%3E%3E8%26255%5D%5Ew%5Be%26255%5D%5Ed%5Bp%2B1%5D%2Cl%3Da%5Bg%3E%3E%3E24%5D%5Eq%5Bb%3E%3E16%26255%5D%5Ev%5Be%3E%3E8%26255%5D%5Ew%5Bf%26255%5D%5Ed%5Bp%2B2%5D%2Cb%3Da%5Bb%3E%3E%3E24%5D%5Eq%5Be%3E%3E16%26255%5D%5Ev%5Bf%3E%3E8%26255%5D%5Ew%5Bg%26255%5D%5Ed%5Bp%2B3%5D%2Cp%2B%3D4%2Ce%3Dh%2Cf%3Dk%2Cg%3Dl%3Bfor(m%3D%0A0%3B4%3Em%3Bm%2B%2B)r%5Bc%3F3%26-m%3Am%5D%3Dx%5Be%3E%3E%3E24%5D%3C%3C24%5Ex%5Bf%3E%3E16%26255%5D%3C%3C16%5Ex%5Bg%3E%3E8%26255%5D%3C%3C8%5Ex%5Bb%26255%5D%5Ed%5Bp%2B%2B%5D%2Ch%3De%2Ce%3Df%2Cf%3Dg%2Cg%3Db%2Cb%3Dh%3Breturn%20r%7D%0Asjcl.bitArray%3D%7BbitSlice%3Afunction(a%2Cb%2Cc)%7Ba%3Dsjcl.bitArray.%24(a.slice(b%2F32)%2C32-(b%2631)).slice(1)%3Breturn%20void%200%3D%3D%3Dc%3Fa%3Asjcl.bitArray.clamp(a%2Cc-b)%7D%2Cextract%3Afunction(a%2Cb%2Cc)%7Bvar%20d%3DMath.floor(-b-c%2631)%3Breturn((b%2Bc-1%5Eb)%26-32%3Fa%5Bb%2F32%7C0%5D%3C%3C32-d%5Ea%5Bb%2F32%2B1%7C0%5D%3E%3E%3Ed%3Aa%5Bb%2F32%7C0%5D%3E%3E%3Ed)%26(1%3C%3Cc)-1%7D%2Cconcat%3Afunction(a%2Cb)%7Bif(0%3D%3D%3Da.length%7C%7C0%3D%3D%3Db.length)return%20a.concat(b)%3Bvar%20c%3Da%5Ba.length-1%5D%2Cd%3Dsjcl.bitArray.getPartial(c)%3Breturn%2032%3D%3D%3Dd%3Fa.concat(b)%3Asjcl.bitArray.%24(b%2Cd%2Cc%7C0%2Ca.slice(0%2Ca.length-1))%7D%2CbitLength%3Afunction(a)%7Bvar%20b%3Da.length%3Breturn%200%3D%3D%3D%0Ab%3F0%3A32*(b-1)%2Bsjcl.bitArray.getPartial(a%5Bb-1%5D)%7D%2Cclamp%3Afunction(a%2Cb)%7Bif(32*a.length%3Cb)return%20a%3Ba%3Da.slice(0%2CMath.ceil(b%2F32))%3Bvar%20c%3Da.length%3Bb%3Db%2631%3B0%3Cc%26%26b%26%26(a%5Bc-1%5D%3Dsjcl.bitArray.partial(b%2Ca%5Bc-1%5D%262147483648%3E%3Eb-1%2C1))%3Breturn%20a%7D%2Cpartial%3Afunction(a%2Cb%2Cc)%7Breturn%2032%3D%3D%3Da%3Fb%3A(c%3Fb%7C0%3Ab%3C%3C32-a)%2B0x10000000000*a%7D%2CgetPartial%3Afunction(a)%7Breturn%20Math.round(a%2F0x10000000000)%7C%7C32%7D%2Cequal%3Afunction(a%2Cb)%7Bif(sjcl.bitArray.bitLength(a)!%3D%3Dsjcl.bitArray.bitLength(b))return!1%3Bvar%20c%3D0%2Cd%3Bfor(d%3D0%3Bd%3Ca.length%3Bd%2B%2B)c%7C%3Da%5Bd%5D%5Eb%5Bd%5D%3Breturn%200%3D%3D%3D%0Ac%7D%2C%24%3Afunction(a%2Cb%2Cc%2Cd)%7Bvar%20e%3Be%3D0%3Bfor(void%200%3D%3D%3Dd%26%26(d%3D%5B%5D)%3B32%3C%3Db%3Bb-%3D32)d.push(c)%2Cc%3D0%3Bif(0%3D%3D%3Db)return%20d.concat(a)%3Bfor(e%3D0%3Be%3Ca.length%3Be%2B%2B)d.push(c%7Ca%5Be%5D%3E%3E%3Eb)%2Cc%3Da%5Be%5D%3C%3C32-b%3Be%3Da.length%3Fa%5Ba.length-1%5D%3A0%3Ba%3Dsjcl.bitArray.getPartial(e)%3Bd.push(sjcl.bitArray.partial(b%2Ba%2631%2C32%3Cb%2Ba%3Fc%3Ad.pop()%2C1))%3Breturn%20d%7D%2Ci%3Afunction(a%2Cb)%7Breturn%5Ba%5B0%5D%5Eb%5B0%5D%2Ca%5B1%5D%5Eb%5B1%5D%2Ca%5B2%5D%5Eb%5B2%5D%2Ca%5B3%5D%5Eb%5B3%5D%5D%7D%2CbyteswapM%3Afunction(a)%7Bvar%20b%2Cc%3Bfor(b%3D0%3Bb%3Ca.length%3B%2B%2Bb)c%3Da%5Bb%5D%2Ca%5Bb%5D%3Dc%3E%3E%3E24%7Cc%3E%3E%3E8%260xff00%7C(c%260xff00)%3C%3C8%7Cc%3C%3C24%3Breturn%20a%7D%7D%3B%0Asjcl.codec.utf8String%3D%7BfromBits%3Afunction(a)%7Bvar%20b%3D%22%22%2Cc%3Dsjcl.bitArray.bitLength(a)%2Cd%2Ce%3Bfor(d%3D0%3Bd%3Cc%2F8%3Bd%2B%2B)0%3D%3D%3D(d%263)%26%26(e%3Da%5Bd%2F4%5D)%2Cb%2B%3DString.fromCharCode(e%3E%3E%3E8%3E%3E%3E8%3E%3E%3E8)%2Ce%3C%3C%3D8%3Breturn%20decodeURIComponent(escape(b))%7D%2CtoBits%3Afunction(a)%7Ba%3Dunescape(encodeURIComponent(a))%3Bvar%20b%3D%5B%5D%2Cc%2Cd%3D0%3Bfor(c%3D0%3Bc%3Ca.length%3Bc%2B%2B)d%3Dd%3C%3C8%7Ca.charCodeAt(c)%2C3%3D%3D%3D(c%263)%26%26(b.push(d)%2Cd%3D0)%3Bc%263%26%26b.push(sjcl.bitArray.partial(8*(c%263)%2Cd))%3Breturn%20b%7D%7D%3B%0Asjcl.codec.hex%3D%7BfromBits%3Afunction(a)%7Bvar%20b%3D%22%22%2Cc%3Bfor(c%3D0%3Bc%3Ca.length%3Bc%2B%2B)b%2B%3D((a%5Bc%5D%7C0)%2B0xf00000000000).toString(16).substr(4)%3Breturn%20b.substr(0%2Csjcl.bitArray.bitLength(a)%2F4)%7D%2CtoBits%3Afunction(a)%7Bvar%20b%2Cc%3D%5B%5D%2Cd%3Ba%3Da.replace(%2F%5Cs%7C0x%2Fg%2C%22%22)%3Bd%3Da.length%3Ba%3Da%2B%2200000000%22%3Bfor(b%3D0%3Bb%3Ca.length%3Bb%2B%3D8)c.push(parseInt(a.substr(b%2C8)%2C16)%5E0)%3Breturn%20sjcl.bitArray.clamp(c%2C4*d)%7D%7D%3B%0Asjcl.codec.base32%3D%7BB%3A%22ABCDEFGHIJKLMNOPQRSTUVWXYZ234567%22%2CX%3A%220123456789ABCDEFGHIJKLMNOPQRSTUV%22%2CBITS%3A32%2CBASE%3A5%2CREMAINING%3A27%2CfromBits%3Afunction(a%2Cb%2Cc)%7Bvar%20d%3Dsjcl.codec.base32.BASE%2Ce%3Dsjcl.codec.base32.REMAINING%2Cf%3D%22%22%2Cg%3D0%2Ch%3Dsjcl.codec.base32.B%2Ck%3D0%2Cl%3Dsjcl.bitArray.bitLength(a)%3Bc%26%26(h%3Dsjcl.codec.base32.X)%3Bfor(c%3D0%3Bf.length*d%3Cl%3B)f%2B%3Dh.charAt((k%5Ea%5Bc%5D%3E%3E%3Eg)%3E%3E%3Ee)%2Cg%3Cd%3F(k%3Da%5Bc%5D%3C%3Cd-g%2Cg%2B%3De%2Cc%2B%2B)%3A(k%3C%3C%3Dd%2Cg-%3Dd)%3Bfor(%3Bf.length%267%26%26!b%3B)f%2B%3D%22%3D%22%3Breturn%20f%7D%2CtoBits%3Afunction(a%2Cb)%7Ba%3Da.replace(%2F%5Cs%7C%3D%2Fg%2C%22%22).toUpperCase()%3Bvar%20c%3Dsjcl.codec.base32.BITS%2C%0Ad%3Dsjcl.codec.base32.BASE%2Ce%3Dsjcl.codec.base32.REMAINING%2Cf%3D%5B%5D%2Cg%2Ch%3D0%2Ck%3Dsjcl.codec.base32.B%2Cl%3D0%2Cn%2Cm%3D%22base32%22%3Bb%26%26(k%3Dsjcl.codec.base32.X%2Cm%3D%22base32hex%22)%3Bfor(g%3D0%3Bg%3Ca.length%3Bg%2B%2B)%7Bn%3Dk.indexOf(a.charAt(g))%3Bif(0%3En)%7Bif(!b)try%7Breturn%20sjcl.codec.base32hex.toBits(a)%7Dcatch(p)%7B%7Dthrow%20new%20sjcl.exception.invalid(%22this%20isn\'t%20%22%2Bm%2B%22!%22)%3B%7Dh%3Ee%3F(h-%3De%2Cf.push(l%5En%3E%3E%3Eh)%2Cl%3Dn%3C%3Cc-h)%3A(h%2B%3Dd%2Cl%5E%3Dn%3C%3Cc-h)%7Dh%2656%26%26f.push(sjcl.bitArray.partial(h%2656%2Cl%2C1))%3Breturn%20f%7D%7D%3B%0Asjcl.codec.base32hex%3D%7BfromBits%3Afunction(a%2Cb)%7Breturn%20sjcl.codec.base32.fromBits(a%2Cb%2C1)%7D%2CtoBits%3Afunction(a)%7Breturn%20sjcl.codec.base32.toBits(a%2C1)%7D%7D%3B%0Asjcl.codec.base64%3D%7BB%3A%22ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%2B%2F%22%2CfromBits%3Afunction(a%2Cb%2Cc)%7Bvar%20d%3D%22%22%2Ce%3D0%2Cf%3Dsjcl.codec.base64.B%2Cg%3D0%2Ch%3Dsjcl.bitArray.bitLength(a)%3Bc%26%26(f%3Df.substr(0%2C62)%2B%22-_%22)%3Bfor(c%3D0%3B6*d.length%3Ch%3B)d%2B%3Df.charAt((g%5Ea%5Bc%5D%3E%3E%3Ee)%3E%3E%3E26)%2C6%3Ee%3F(g%3Da%5Bc%5D%3C%3C6-e%2Ce%2B%3D26%2Cc%2B%2B)%3A(g%3C%3C%3D6%2Ce-%3D6)%3Bfor(%3Bd.length%263%26%26!b%3B)d%2B%3D%22%3D%22%3Breturn%20d%7D%2CtoBits%3Afunction(a%2Cb)%7Ba%3Da.replace(%2F%5Cs%7C%3D%2Fg%2C%22%22)%3Bvar%20c%3D%5B%5D%2Cd%2Ce%3D0%2Cf%3Dsjcl.codec.base64.B%2Cg%3D0%2Ch%3Bb%26%26(f%3Df.substr(0%2C62)%2B%22-_%22)%3Bfor(d%3D0%3Bd%3Ca.length%3Bd%2B%2B)%7Bh%3Df.indexOf(a.charAt(d))%3B%0Aif(0%3Eh)throw%20new%20sjcl.exception.invalid(%22this%20isn\'t%20base64!%22)%3B26%3Ce%3F(e-%3D26%2Cc.push(g%5Eh%3E%3E%3Ee)%2Cg%3Dh%3C%3C32-e)%3A(e%2B%3D6%2Cg%5E%3Dh%3C%3C32-e)%7De%2656%26%26c.push(sjcl.bitArray.partial(e%2656%2Cg%2C1))%3Breturn%20c%7D%7D%3Bsjcl.codec.base64url%3D%7BfromBits%3Afunction(a)%7Breturn%20sjcl.codec.base64.fromBits(a%2C1%2C1)%7D%2CtoBits%3Afunction(a)%7Breturn%20sjcl.codec.base64.toBits(a%2C1)%7D%7D%3Bsjcl.hash.sha256%3Dfunction(a)%7Bthis.b%5B0%5D%7C%7Cthis.O()%3Ba%3F(this.F%3Da.F.slice(0)%2Cthis.A%3Da.A.slice(0)%2Cthis.l%3Da.l)%3Athis.reset()%7D%3Bsjcl.hash.sha256.hash%3Dfunction(a)%7Breturn(new%20sjcl.hash.sha256).update(a).finalize()%7D%3B%0Asjcl.hash.sha256.prototype%3D%7BblockSize%3A512%2Creset%3Afunction()%7Bthis.F%3Dthis.Y.slice(0)%3Bthis.A%3D%5B%5D%3Bthis.l%3D0%3Breturn%20this%7D%2Cupdate%3Afunction(a)%7B%22string%22%3D%3D%3Dtypeof%20a%26%26(a%3Dsjcl.codec.utf8String.toBits(a))%3Bvar%20b%2Cc%3Dthis.A%3Dsjcl.bitArray.concat(this.A%2Ca)%3Bb%3Dthis.l%3Ba%3Dthis.l%3Db%2Bsjcl.bitArray.bitLength(a)%3Bif(0x1fffffffffffff%3Ca)throw%20new%20sjcl.exception.invalid(%22Cannot%20hash%20more%20than%202%5E53%20-%201%20bits%22)%3Bif(%22undefined%22!%3D%3Dtypeof%20Uint32Array)%7Bvar%20d%3Dnew%20Uint32Array(c)%2Ce%3D0%3Bfor(b%3D512%2Bb-(512%2Bb%260x1ff)%3Bb%3C%3Da%3Bb%2B%3D512)u(this%2Cd.subarray(16*e%2C%0A16*(e%2B1)))%2Ce%2B%3D1%3Bc.splice(0%2C16*e)%7Delse%20for(b%3D512%2Bb-(512%2Bb%260x1ff)%3Bb%3C%3Da%3Bb%2B%3D512)u(this%2Cc.splice(0%2C16))%3Breturn%20this%7D%2Cfinalize%3Afunction()%7Bvar%20a%2Cb%3Dthis.A%2Cc%3Dthis.F%2Cb%3Dsjcl.bitArray.concat(b%2C%5Bsjcl.bitArray.partial(1%2C1)%5D)%3Bfor(a%3Db.length%2B2%3Ba%2615%3Ba%2B%2B)b.push(0)%3Bb.push(Math.floor(this.l%2F0x100000000))%3Bfor(b.push(this.l%7C0)%3Bb.length%3B)u(this%2Cb.splice(0%2C16))%3Bthis.reset()%3Breturn%20c%7D%2CY%3A%5B%5D%2Cb%3A%5B%5D%2CO%3Afunction()%7Bfunction%20a(a)%7Breturn%200x100000000*(a-Math.floor(a))%7C0%7Dfor(var%20b%3D0%2Cc%3D2%2Cd%2Ce%3B64%3Eb%3Bc%2B%2B)%7Be%3D!0%3Bfor(d%3D2%3Bd*d%3C%3Dc%3Bd%2B%2B)if(0%3D%3D%3Dc%25d)%7Be%3D%0A!1%3Bbreak%7De%26%26(8%3Eb%26%26(this.Y%5Bb%5D%3Da(Math.pow(c%2C.5)))%2Cthis.b%5Bb%5D%3Da(Math.pow(c%2C1%2F3))%2Cb%2B%2B)%7D%7D%7D%3B%0Afunction%20u(a%2Cb)%7Bvar%20c%2Cd%2Ce%2Cf%3Da.F%2Cg%3Da.b%2Ch%3Df%5B0%5D%2Ck%3Df%5B1%5D%2Cl%3Df%5B2%5D%2Cn%3Df%5B3%5D%2Cm%3Df%5B4%5D%2Cp%3Df%5B5%5D%2Cr%3Df%5B6%5D%2Cq%3Df%5B7%5D%3Bfor(c%3D0%3B64%3Ec%3Bc%2B%2B)16%3Ec%3Fd%3Db%5Bc%5D%3A(d%3Db%5Bc%2B1%2615%5D%2Ce%3Db%5Bc%2B14%2615%5D%2Cd%3Db%5Bc%2615%5D%3D(d%3E%3E%3E7%5Ed%3E%3E%3E18%5Ed%3E%3E%3E3%5Ed%3C%3C25%5Ed%3C%3C14)%2B(e%3E%3E%3E17%5Ee%3E%3E%3E19%5Ee%3E%3E%3E10%5Ee%3C%3C15%5Ee%3C%3C13)%2Bb%5Bc%2615%5D%2Bb%5Bc%2B9%2615%5D%7C0)%2Cd%3Dd%2Bq%2B(m%3E%3E%3E6%5Em%3E%3E%3E11%5Em%3E%3E%3E25%5Em%3C%3C26%5Em%3C%3C21%5Em%3C%3C7)%2B(r%5Em%26(p%5Er))%2Bg%5Bc%5D%2Cq%3Dr%2Cr%3Dp%2Cp%3Dm%2Cm%3Dn%2Bd%7C0%2Cn%3Dl%2Cl%3Dk%2Ck%3Dh%2Ch%3Dd%2B(k%26l%5En%26(k%5El))%2B(k%3E%3E%3E2%5Ek%3E%3E%3E13%5Ek%3E%3E%3E22%5Ek%3C%3C30%5Ek%3C%3C19%5Ek%3C%3C10)%7C0%3Bf%5B0%5D%3Df%5B0%5D%2Bh%7C0%3Bf%5B1%5D%3Df%5B1%5D%2Bk%7C0%3Bf%5B2%5D%3Df%5B2%5D%2Bl%7C0%3Bf%5B3%5D%3Df%5B3%5D%2Bn%7C0%3Bf%5B4%5D%3Df%5B4%5D%2Bm%7C0%3Bf%5B5%5D%3Df%5B5%5D%2Bp%7C0%3Bf%5B6%5D%3Df%5B6%5D%2Br%7C0%3Bf%5B7%5D%3D%0Af%5B7%5D%2Bq%7C0%7D%0Asjcl.mode.ccm%3D%7Bname%3A%22ccm%22%2CG%3A%5B%5D%2ClistenProgress%3Afunction(a)%7Bsjcl.mode.ccm.G.push(a)%7D%2CunListenProgress%3Afunction(a)%7Ba%3Dsjcl.mode.ccm.G.indexOf(a)%3B-1%3Ca%26%26sjcl.mode.ccm.G.splice(a%2C1)%7D%2Cfa%3Afunction(a)%7Bvar%20b%3Dsjcl.mode.ccm.G.slice()%2Cc%3Bfor(c%3D0%3Bc%3Cb.length%3Bc%2B%3D1)b%5Bc%5D(a)%7D%2Cencrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce)%7Bvar%20f%2Cg%3Db.slice(0)%2Ch%3Dsjcl.bitArray%2Ck%3Dh.bitLength(c)%2F8%2Cl%3Dh.bitLength(g)%2F8%3Be%3De%7C%7C64%3Bd%3Dd%7C%7C%5B%5D%3Bif(7%3Ek)throw%20new%20sjcl.exception.invalid(%22ccm%3A%20iv%20must%20be%20at%20least%207%20bytes%22)%3Bfor(f%3D2%3B4%3Ef%26%26l%3E%3E%3E8*f%3Bf%2B%2B)%3Bf%3C15-k%26%26(f%3D15-k)%3Bc%3Dh.clamp(c%2C%0A8*(15-f))%3Bb%3Dsjcl.mode.ccm.V(a%2Cb%2Cc%2Cd%2Ce%2Cf)%3Bg%3Dsjcl.mode.ccm.C(a%2Cg%2Cc%2Cb%2Ce%2Cf)%3Breturn%20h.concat(g.data%2Cg.tag)%7D%2Cdecrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce)%7Be%3De%7C%7C64%3Bd%3Dd%7C%7C%5B%5D%3Bvar%20f%3Dsjcl.bitArray%2Cg%3Df.bitLength(c)%2F8%2Ch%3Df.bitLength(b)%2Ck%3Df.clamp(b%2Ch-e)%2Cl%3Df.bitSlice(b%2Ch-e)%2Ch%3D(h-e)%2F8%3Bif(7%3Eg)throw%20new%20sjcl.exception.invalid(%22ccm%3A%20iv%20must%20be%20at%20least%207%20bytes%22)%3Bfor(b%3D2%3B4%3Eb%26%26h%3E%3E%3E8*b%3Bb%2B%2B)%3Bb%3C15-g%26%26(b%3D15-g)%3Bc%3Df.clamp(c%2C8*(15-b))%3Bk%3Dsjcl.mode.ccm.C(a%2Ck%2Cc%2Cl%2Ce%2Cb)%3Ba%3Dsjcl.mode.ccm.V(a%2Ck.data%2Cc%2Cd%2Ce%2Cb)%3Bif(!f.equal(k.tag%2Ca))throw%20new%20sjcl.exception.corrupt(%22ccm%3A%20tag%20doesn\'t%20match%22)%3B%0Areturn%20k.data%7D%2Cna%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7Bvar%20g%3D%5B%5D%2Ch%3Dsjcl.bitArray%2Ck%3Dh.i%3Bd%3D%5Bh.partial(8%2C(b.length%3F64%3A0)%7Cd-2%3C%3C2%7Cf-1)%5D%3Bd%3Dh.concat(d%2Cc)%3Bd%5B3%5D%7C%3De%3Bd%3Da.encrypt(d)%3Bif(b.length)for(c%3Dh.bitLength(b)%2F8%2C65279%3E%3Dc%3Fg%3D%5Bh.partial(16%2Cc)%5D%3A0xffffffff%3E%3Dc%26%26(g%3Dh.concat(%5Bh.partial(16%2C65534)%5D%2C%5Bc%5D))%2Cg%3Dh.concat(g%2Cb)%2Cb%3D0%3Bb%3Cg.length%3Bb%2B%3D4)d%3Da.encrypt(k(d%2Cg.slice(b%2Cb%2B4).concat(%5B0%2C0%2C0%5D)))%3Breturn%20d%7D%2CV%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7Bvar%20g%3Dsjcl.bitArray%2Ch%3Dg.i%3Be%2F%3D8%3Bif(e%252%7C%7C4%3Ee%7C%7C16%3Ce)throw%20new%20sjcl.exception.invalid(%22ccm%3A%20invalid%20tag%20length%22)%3B%0Aif(0xffffffff%3Cd.length%7C%7C0xffffffff%3Cb.length)throw%20new%20sjcl.exception.bug(%22ccm%3A%20can\'t%20deal%20with%204GiB%20or%20more%20data%22)%3Bc%3Dsjcl.mode.ccm.na(a%2Cd%2Cc%2Ce%2Cg.bitLength(b)%2F8%2Cf)%3Bfor(d%3D0%3Bd%3Cb.length%3Bd%2B%3D4)c%3Da.encrypt(h(c%2Cb.slice(d%2Cd%2B4).concat(%5B0%2C0%2C0%5D)))%3Breturn%20g.clamp(c%2C8*e)%7D%2CC%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7Bvar%20g%2Ch%3Dsjcl.bitArray%3Bg%3Dh.i%3Bvar%20k%3Db.length%2Cl%3Dh.bitLength(b)%2Cn%3Dk%2F50%2Cm%3Dn%3Bc%3Dh.concat(%5Bh.partial(8%2Cf-1)%5D%2Cc).concat(%5B0%2C0%2C0%5D).slice(0%2C4)%3Bd%3Dh.bitSlice(g(d%2Ca.encrypt(c))%2C0%2Ce)%3Bif(!k)return%7Btag%3Ad%2Cdata%3A%5B%5D%7D%3Bfor(g%3D0%3Bg%3Ck%3Bg%2B%3D4)g%3En%26%26(sjcl.mode.ccm.fa(g%2F%0Ak)%2Cn%2B%3Dm)%2Cc%5B3%5D%2B%2B%2Ce%3Da.encrypt(c)%2Cb%5Bg%5D%5E%3De%5B0%5D%2Cb%5Bg%2B1%5D%5E%3De%5B1%5D%2Cb%5Bg%2B2%5D%5E%3De%5B2%5D%2Cb%5Bg%2B3%5D%5E%3De%5B3%5D%3Breturn%7Btag%3Ad%2Cdata%3Ah.clamp(b%2Cl)%7D%7D%7D%3B%0Asjcl.mode.ocb2%3D%7Bname%3A%22ocb2%22%2Cencrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7Bif(128!%3D%3Dsjcl.bitArray.bitLength(c))throw%20new%20sjcl.exception.invalid(%22ocb%20iv%20must%20be%20128%20bits%22)%3Bvar%20g%2Ch%3Dsjcl.mode.ocb2.S%2Ck%3Dsjcl.bitArray%2Cl%3Dk.i%2Cn%3D%5B0%2C0%2C0%2C0%5D%3Bc%3Dh(a.encrypt(c))%3Bvar%20m%2Cp%3D%5B%5D%3Bd%3Dd%7C%7C%5B%5D%3Be%3De%7C%7C64%3Bfor(g%3D0%3Bg%2B4%3Cb.length%3Bg%2B%3D4)m%3Db.slice(g%2Cg%2B4)%2Cn%3Dl(n%2Cm)%2Cp%3Dp.concat(l(c%2Ca.encrypt(l(c%2Cm))))%2Cc%3Dh(c)%3Bm%3Db.slice(g)%3Bb%3Dk.bitLength(m)%3Bg%3Da.encrypt(l(c%2C%5B0%2C0%2C0%2Cb%5D))%3Bm%3Dk.clamp(l(m.concat(%5B0%2C0%2C0%5D)%2Cg)%2Cb)%3Bn%3Dl(n%2Cl(m.concat(%5B0%2C0%2C0%5D)%2Cg))%3Bn%3Da.encrypt(l(n%2Cl(c%2Ch(c))))%3B%0Ad.length%26%26(n%3Dl(n%2Cf%3Fd%3Asjcl.mode.ocb2.pmac(a%2Cd)))%3Breturn%20p.concat(k.concat(m%2Ck.clamp(n%2Ce)))%7D%2Cdecrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7Bif(128!%3D%3Dsjcl.bitArray.bitLength(c))throw%20new%20sjcl.exception.invalid(%22ocb%20iv%20must%20be%20128%20bits%22)%3Be%3De%7C%7C64%3Bvar%20g%3Dsjcl.mode.ocb2.S%2Ch%3Dsjcl.bitArray%2Ck%3Dh.i%2Cl%3D%5B0%2C0%2C0%2C0%5D%2Cn%3Dg(a.encrypt(c))%2Cm%2Cp%2Cr%3Dsjcl.bitArray.bitLength(b)-e%2Cq%3D%5B%5D%3Bd%3Dd%7C%7C%5B%5D%3Bfor(c%3D0%3Bc%2B4%3Cr%2F32%3Bc%2B%3D4)m%3Dk(n%2Ca.decrypt(k(n%2Cb.slice(c%2Cc%2B4))))%2Cl%3Dk(l%2Cm)%2Cq%3Dq.concat(m)%2Cn%3Dg(n)%3Bp%3Dr-32*c%3Bm%3Da.encrypt(k(n%2C%5B0%2C0%2C0%2Cp%5D))%3Bm%3Dk(m%2Ch.clamp(b.slice(c)%2Cp).concat(%5B0%2C%0A0%2C0%5D))%3Bl%3Dk(l%2Cm)%3Bl%3Da.encrypt(k(l%2Ck(n%2Cg(n))))%3Bd.length%26%26(l%3Dk(l%2Cf%3Fd%3Asjcl.mode.ocb2.pmac(a%2Cd)))%3Bif(!h.equal(h.clamp(l%2Ce)%2Ch.bitSlice(b%2Cr)))throw%20new%20sjcl.exception.corrupt(%22ocb%3A%20tag%20doesn\'t%20match%22)%3Breturn%20q.concat(h.clamp(m%2Cp))%7D%2Cpmac%3Afunction(a%2Cb)%7Bvar%20c%2Cd%3Dsjcl.mode.ocb2.S%2Ce%3Dsjcl.bitArray%2Cf%3De.i%2Cg%3D%5B0%2C0%2C0%2C0%5D%2Ch%3Da.encrypt(%5B0%2C0%2C0%2C0%5D)%2Ch%3Df(h%2Cd(d(h)))%3Bfor(c%3D0%3Bc%2B4%3Cb.length%3Bc%2B%3D4)h%3Dd(h)%2Cg%3Df(g%2Ca.encrypt(f(h%2Cb.slice(c%2Cc%2B4))))%3Bc%3Db.slice(c)%3B128%3Ee.bitLength(c)%26%26(h%3Df(h%2Cd(h))%2Cc%3De.concat(c%2C%5B-2147483648%2C0%2C0%2C0%5D))%3Bg%3Df(g%2Cc)%3B%0Areturn%20a.encrypt(f(d(f(h%2Cd(h)))%2Cg))%7D%2CS%3Afunction(a)%7Breturn%5Ba%5B0%5D%3C%3C1%5Ea%5B1%5D%3E%3E%3E31%2Ca%5B1%5D%3C%3C1%5Ea%5B2%5D%3E%3E%3E31%2Ca%5B2%5D%3C%3C1%5Ea%5B3%5D%3E%3E%3E31%2Ca%5B3%5D%3C%3C1%5E135*(a%5B0%5D%3E%3E%3E31)%5D%7D%7D%3B%0Asjcl.mode.gcm%3D%7Bname%3A%22gcm%22%2Cencrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce)%7Bvar%20f%3Db.slice(0)%3Bb%3Dsjcl.bitArray%3Bd%3Dd%7C%7C%5B%5D%3Ba%3Dsjcl.mode.gcm.C(!0%2Ca%2Cf%2Cd%2Cc%2Ce%7C%7C128)%3Breturn%20b.concat(a.data%2Ca.tag)%7D%2Cdecrypt%3Afunction(a%2Cb%2Cc%2Cd%2Ce)%7Bvar%20f%3Db.slice(0)%2Cg%3Dsjcl.bitArray%2Ch%3Dg.bitLength(f)%3Be%3De%7C%7C128%3Bd%3Dd%7C%7C%5B%5D%3Be%3C%3Dh%3F(b%3Dg.bitSlice(f%2Ch-e)%2Cf%3Dg.bitSlice(f%2C0%2Ch-e))%3A(b%3Df%2Cf%3D%5B%5D)%3Ba%3Dsjcl.mode.gcm.C(!1%2Ca%2Cf%2Cd%2Cc%2Ce)%3Bif(!g.equal(a.tag%2Cb))throw%20new%20sjcl.exception.corrupt(%22gcm%3A%20tag%20doesn\'t%20match%22)%3Breturn%20a.data%7D%2Cka%3Afunction(a%2Cb)%7Bvar%20c%2Cd%2Ce%2Cf%2Cg%2Ch%3Dsjcl.bitArray.i%3Be%3D%5B0%2C0%2C%0A0%2C0%5D%3Bf%3Db.slice(0)%3Bfor(c%3D0%3B128%3Ec%3Bc%2B%2B)%7B(d%3D0!%3D%3D(a%5BMath.floor(c%2F32)%5D%261%3C%3C31-c%2532))%26%26(e%3Dh(e%2Cf))%3Bg%3D0!%3D%3D(f%5B3%5D%261)%3Bfor(d%3D3%3B0%3Cd%3Bd--)f%5Bd%5D%3Df%5Bd%5D%3E%3E%3E1%7C(f%5Bd-1%5D%261)%3C%3C31%3Bf%5B0%5D%3E%3E%3E%3D1%3Bg%26%26(f%5B0%5D%5E%3D-0x1f000000)%7Dreturn%20e%7D%2Cj%3Afunction(a%2Cb%2Cc)%7Bvar%20d%2Ce%3Dc.length%3Bb%3Db.slice(0)%3Bfor(d%3D0%3Bd%3Ce%3Bd%2B%3D4)b%5B0%5D%5E%3D0xffffffff%26c%5Bd%5D%2Cb%5B1%5D%5E%3D0xffffffff%26c%5Bd%2B1%5D%2Cb%5B2%5D%5E%3D0xffffffff%26c%5Bd%2B2%5D%2Cb%5B3%5D%5E%3D0xffffffff%26c%5Bd%2B3%5D%2Cb%3Dsjcl.mode.gcm.ka(b%2Ca)%3Breturn%20b%7D%2CC%3Afunction(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7Bvar%20g%2Ch%2Ck%2Cl%2Cn%2Cm%2Cp%2Cr%2Cq%3Dsjcl.bitArray%3Bm%3Dc.length%3Bp%3Dq.bitLength(c)%3Br%3Dq.bitLength(d)%3Bh%3Dq.bitLength(e)%3B%0Ag%3Db.encrypt(%5B0%2C0%2C0%2C0%5D)%3B96%3D%3D%3Dh%3F(e%3De.slice(0)%2Ce%3Dq.concat(e%2C%5B1%5D))%3A(e%3Dsjcl.mode.gcm.j(g%2C%5B0%2C0%2C0%2C0%5D%2Ce)%2Ce%3Dsjcl.mode.gcm.j(g%2Ce%2C%5B0%2C0%2CMath.floor(h%2F0x100000000)%2Ch%260xffffffff%5D))%3Bh%3Dsjcl.mode.gcm.j(g%2C%5B0%2C0%2C0%2C0%5D%2Cd)%3Bn%3De.slice(0)%3Bd%3Dh.slice(0)%3Ba%7C%7C(d%3Dsjcl.mode.gcm.j(g%2Ch%2Cc))%3Bfor(l%3D0%3Bl%3Cm%3Bl%2B%3D4)n%5B3%5D%2B%2B%2Ck%3Db.encrypt(n)%2Cc%5Bl%5D%5E%3Dk%5B0%5D%2Cc%5Bl%2B1%5D%5E%3Dk%5B1%5D%2Cc%5Bl%2B2%5D%5E%3Dk%5B2%5D%2Cc%5Bl%2B3%5D%5E%3Dk%5B3%5D%3Bc%3Dq.clamp(c%2Cp)%3Ba%26%26(d%3Dsjcl.mode.gcm.j(g%2Ch%2Cc))%3Ba%3D%5BMath.floor(r%2F0x100000000)%2Cr%260xffffffff%2CMath.floor(p%2F0x100000000)%2Cp%260xffffffff%5D%3Bd%3Dsjcl.mode.gcm.j(g%2Cd%2Ca)%3Bk%3Db.encrypt(e)%3B%0Ad%5B0%5D%5E%3Dk%5B0%5D%3Bd%5B1%5D%5E%3Dk%5B1%5D%3Bd%5B2%5D%5E%3Dk%5B2%5D%3Bd%5B3%5D%5E%3Dk%5B3%5D%3Breturn%7Btag%3Aq.bitSlice(d%2C0%2Cf)%2Cdata%3Ac%7D%7D%7D%3Bsjcl.misc.hmac%3Dfunction(a%2Cb)%7Bthis.W%3Db%3Db%7C%7Csjcl.hash.sha256%3Bvar%20c%3D%5B%5B%5D%2C%5B%5D%5D%2Cd%2Ce%3Db.prototype.blockSize%2F32%3Bthis.w%3D%5Bnew%20b%2Cnew%20b%5D%3Ba.length%3Ee%26%26(a%3Db.hash(a))%3Bfor(d%3D0%3Bd%3Ce%3Bd%2B%2B)c%5B0%5D%5Bd%5D%3Da%5Bd%5D%5E909522486%2Cc%5B1%5D%5Bd%5D%3Da%5Bd%5D%5E1549556828%3Bthis.w%5B0%5D.update(c%5B0%5D)%3Bthis.w%5B1%5D.update(c%5B1%5D)%3Bthis.R%3Dnew%20b(this.w%5B0%5D)%7D%3B%0Asjcl.misc.hmac.prototype.encrypt%3Dsjcl.misc.hmac.prototype.mac%3Dfunction(a)%7Bif(this.aa)throw%20new%20sjcl.exception.invalid(%22encrypt%20on%20already%20updated%20hmac%20called!%22)%3Bthis.update(a)%3Breturn%20this.digest(a)%7D%3Bsjcl.misc.hmac.prototype.reset%3Dfunction()%7Bthis.R%3Dnew%20this.W(this.w%5B0%5D)%3Bthis.aa%3D!1%7D%3Bsjcl.misc.hmac.prototype.update%3Dfunction(a)%7Bthis.aa%3D!0%3Bthis.R.update(a)%7D%3Bsjcl.misc.hmac.prototype.digest%3Dfunction()%7Bvar%20a%3Dthis.R.finalize()%2Ca%3D(new%20this.W(this.w%5B1%5D)).update(a).finalize()%3Bthis.reset()%3Breturn%20a%7D%3B%0Asjcl.misc.pbkdf2%3Dfunction(a%2Cb%2Cc%2Cd%2Ce)%7Bc%3Dc%7C%7C1E4%3Bif(0%3Ed%7C%7C0%3Ec)throw%20new%20sjcl.exception.invalid(%22invalid%20params%20to%20pbkdf2%22)%3B%22string%22%3D%3D%3Dtypeof%20a%26%26(a%3Dsjcl.codec.utf8String.toBits(a))%3B%22string%22%3D%3D%3Dtypeof%20b%26%26(b%3Dsjcl.codec.utf8String.toBits(b))%3Be%3De%7C%7Csjcl.misc.hmac%3Ba%3Dnew%20e(a)%3Bvar%20f%2Cg%2Ch%2Ck%2Cl%3D%5B%5D%2Cn%3Dsjcl.bitArray%3Bfor(k%3D1%3B32*l.length%3C(d%7C%7C1)%3Bk%2B%2B)%7Be%3Df%3Da.encrypt(n.concat(b%2C%5Bk%5D))%3Bfor(g%3D1%3Bg%3Cc%3Bg%2B%2B)for(f%3Da.encrypt(f)%2Ch%3D0%3Bh%3Cf.length%3Bh%2B%2B)e%5Bh%5D%5E%3Df%5Bh%5D%3Bl%3Dl.concat(e)%7Dd%26%26(l%3Dn.clamp(l%2Cd))%3Breturn%20l%7D%3B%0Asjcl.prng%3Dfunction(a)%7Bthis.c%3D%5Bnew%20sjcl.hash.sha256%5D%3Bthis.m%3D%5B0%5D%3Bthis.P%3D0%3Bthis.H%3D%7B%7D%3Bthis.N%3D0%3Bthis.U%3D%7B%7D%3Bthis.Z%3Dthis.f%3Dthis.o%3Dthis.ha%3D0%3Bthis.b%3D%5B0%2C0%2C0%2C0%2C0%2C0%2C0%2C0%5D%3Bthis.h%3D%5B0%2C0%2C0%2C0%5D%3Bthis.L%3Dvoid%200%3Bthis.M%3Da%3Bthis.D%3D!1%3Bthis.K%3D%7Bprogress%3A%7B%7D%2Cseeded%3A%7B%7D%7D%3Bthis.u%3Dthis.ga%3D0%3Bthis.I%3D1%3Bthis.J%3D2%3Bthis.ca%3D0x10000%3Bthis.T%3D%5B0%2C48%2C64%2C96%2C128%2C192%2C0x100%2C384%2C512%2C768%2C1024%5D%3Bthis.da%3D3E4%3Bthis.ba%3D80%7D%3B%0Asjcl.prng.prototype%3D%7BrandomWords%3Afunction(a%2Cb)%7Bvar%20c%3D%5B%5D%2Cd%3Bd%3Dthis.isReady(b)%3Bvar%20e%3Bif(d%3D%3D%3Dthis.u)throw%20new%20sjcl.exception.notReady(%22generator%20isn\'t%20seeded%22)%3Bif(d%26this.J)%7Bd%3D!(d%26this.I)%3Be%3D%5B%5D%3Bvar%20f%3D0%2Cg%3Bthis.Z%3De%5B0%5D%3D(new%20Date).valueOf()%2Bthis.da%3Bfor(g%3D0%3B16%3Eg%3Bg%2B%2B)e.push(0x100000000*Math.random()%7C0)%3Bfor(g%3D0%3Bg%3Cthis.c.length%26%26(e%3De.concat(this.c%5Bg%5D.finalize())%2Cf%2B%3Dthis.m%5Bg%5D%2Cthis.m%5Bg%5D%3D0%2Cd%7C%7C!(this.P%261%3C%3Cg))%3Bg%2B%2B)%3Bthis.P%3E%3D1%3C%3Cthis.c.length%26%26(this.c.push(new%20sjcl.hash.sha256)%2Cthis.m.push(0))%3Bthis.f-%3Df%3Bf%3Ethis.o%26%26(this.o%3D%0Af)%3Bthis.P%2B%2B%3Bthis.b%3Dsjcl.hash.sha256.hash(this.b.concat(e))%3Bthis.L%3Dnew%20sjcl.cipher.aes(this.b)%3Bfor(d%3D0%3B4%3Ed%26%26(this.h%5Bd%5D%3Dthis.h%5Bd%5D%2B1%7C0%2C!this.h%5Bd%5D)%3Bd%2B%2B)%3B%7Dfor(d%3D0%3Bd%3Ca%3Bd%2B%3D4)0%3D%3D%3D(d%2B1)%25this.ca%26%26y(this)%2Ce%3Dz(this)%2Cc.push(e%5B0%5D%2Ce%5B1%5D%2Ce%5B2%5D%2Ce%5B3%5D)%3By(this)%3Breturn%20c.slice(0%2Ca)%7D%2CsetDefaultParanoia%3Afunction(a%2Cb)%7Bif(0%3D%3D%3Da%26%26%22Setting%20paranoia%3D0%20will%20ruin%20your%20security%3B%20use%20it%20only%20for%20testing%22!%3D%3Db)throw%20new%20sjcl.exception.invalid(%22Setting%20paranoia%3D0%20will%20ruin%20your%20security%3B%20use%20it%20only%20for%20testing%22)%3Bthis.M%3Da%7D%2CaddEntropy%3Afunction(a%2C%0Ab%2Cc)%7Bc%3Dc%7C%7C%22user%22%3Bvar%20d%2Ce%2Cf%3D(new%20Date).valueOf()%2Cg%3Dthis.H%5Bc%5D%2Ch%3Dthis.isReady()%2Ck%3D0%3Bd%3Dthis.U%5Bc%5D%3Bvoid%200%3D%3D%3Dd%26%26(d%3Dthis.U%5Bc%5D%3Dthis.ha%2B%2B)%3Bvoid%200%3D%3D%3Dg%26%26(g%3Dthis.H%5Bc%5D%3D0)%3Bthis.H%5Bc%5D%3D(this.H%5Bc%5D%2B1)%25this.c.length%3Bswitch(typeof%20a)%7Bcase%20%22number%22%3Avoid%200%3D%3D%3Db%26%26(b%3D1)%3Bthis.c%5Bg%5D.update(%5Bd%2Cthis.N%2B%2B%2C1%2Cb%2Cf%2C1%2Ca%7C0%5D)%3Bbreak%3Bcase%20%22object%22%3Ac%3DObject.prototype.toString.call(a)%3Bif(%22%5Bobject%20Uint32Array%5D%22%3D%3D%3Dc)%7Be%3D%5B%5D%3Bfor(c%3D0%3Bc%3Ca.length%3Bc%2B%2B)e.push(a%5Bc%5D)%3Ba%3De%7Delse%20for(%22%5Bobject%20Array%5D%22!%3D%3Dc%26%26(k%3D1)%2Cc%3D0%3Bc%3Ca.length%26%26!k%3Bc%2B%2B)%22number%22!%3D%3Dtypeof%20a%5Bc%5D%26%26%0A(k%3D1)%3Bif(!k)%7Bif(void%200%3D%3D%3Db)for(c%3Db%3D0%3Bc%3Ca.length%3Bc%2B%2B)for(e%3Da%5Bc%5D%3B0%3Ce%3B)b%2B%2B%2Ce%3De%3E%3E%3E1%3Bthis.c%5Bg%5D.update(%5Bd%2Cthis.N%2B%2B%2C2%2Cb%2Cf%2Ca.length%5D.concat(a))%7Dbreak%3Bcase%20%22string%22%3Avoid%200%3D%3D%3Db%26%26(b%3Da.length)%3Bthis.c%5Bg%5D.update(%5Bd%2Cthis.N%2B%2B%2C3%2Cb%2Cf%2Ca.length%5D)%3Bthis.c%5Bg%5D.update(a)%3Bbreak%3Bdefault%3Ak%3D1%7Dif(k)throw%20new%20sjcl.exception.bug(%22random%3A%20addEntropy%20only%20supports%20number%2C%20array%20of%20numbers%20or%20string%22)%3Bthis.m%5Bg%5D%2B%3Db%3Bthis.f%2B%3Db%3Bh%3D%3D%3Dthis.u%26%26(this.isReady()!%3D%3Dthis.u%26%26A(%22seeded%22%2CMath.max(this.o%2Cthis.f))%2CA(%22progress%22%2Cthis.getProgress()))%7D%2C%0AisReady%3Afunction(a)%7Ba%3Dthis.T%5Bvoid%200!%3D%3Da%3Fa%3Athis.M%5D%3Breturn%20this.o%26%26this.o%3E%3Da%3Fthis.m%5B0%5D%3Ethis.ba%26%26(new%20Date).valueOf()%3Ethis.Z%3Fthis.J%7Cthis.I%3Athis.I%3Athis.f%3E%3Da%3Fthis.J%7Cthis.u%3Athis.u%7D%2CgetProgress%3Afunction(a)%7Ba%3Dthis.T%5Ba%3Fa%3Athis.M%5D%3Breturn%20this.o%3E%3Da%3F1%3Athis.f%3Ea%3F1%3Athis.f%2Fa%7D%2CstartCollectors%3Afunction()%7Bif(!this.D)%7Bthis.a%3D%7BloadTimeCollector%3AB(this%2Cthis.ma)%2CmouseCollector%3AB(this%2Cthis.oa)%2CkeyboardCollector%3AB(this%2Cthis.la)%2CaccelerometerCollector%3AB(this%2Cthis.ea)%2CtouchCollector%3AB(this%2Cthis.qa)%7D%3Bif(window.addEventListener)window.addEventListener(%22load%22%2C%0Athis.a.loadTimeCollector%2C!1)%2Cwindow.addEventListener(%22mousemove%22%2Cthis.a.mouseCollector%2C!1)%2Cwindow.addEventListener(%22keypress%22%2Cthis.a.keyboardCollector%2C!1)%2Cwindow.addEventListener(%22devicemotion%22%2Cthis.a.accelerometerCollector%2C!1)%2Cwindow.addEventListener(%22touchmove%22%2Cthis.a.touchCollector%2C!1)%3Belse%20if(document.attachEvent)document.attachEvent(%22onload%22%2Cthis.a.loadTimeCollector)%2Cdocument.attachEvent(%22onmousemove%22%2Cthis.a.mouseCollector)%2Cdocument.attachEvent(%22keypress%22%2Cthis.a.keyboardCollector)%3Belse%20throw%20new%20sjcl.exception.bug(%22can\'t%20attach%20event%22)%3B%0Athis.D%3D!0%7D%7D%2CstopCollectors%3Afunction()%7Bthis.D%26%26(window.removeEventListener%3F(window.removeEventListener(%22load%22%2Cthis.a.loadTimeCollector%2C!1)%2Cwindow.removeEventListener(%22mousemove%22%2Cthis.a.mouseCollector%2C!1)%2Cwindow.removeEventListener(%22keypress%22%2Cthis.a.keyboardCollector%2C!1)%2Cwindow.removeEventListener(%22devicemotion%22%2Cthis.a.accelerometerCollector%2C!1)%2Cwindow.removeEventListener(%22touchmove%22%2Cthis.a.touchCollector%2C!1))%3Adocument.detachEvent%26%26(document.detachEvent(%22onload%22%2Cthis.a.loadTimeCollector)%2Cdocument.detachEvent(%22onmousemove%22%2C%0Athis.a.mouseCollector)%2Cdocument.detachEvent(%22keypress%22%2Cthis.a.keyboardCollector))%2Cthis.D%3D!1)%7D%2CaddEventListener%3Afunction(a%2Cb)%7Bthis.K%5Ba%5D%5Bthis.ga%2B%2B%5D%3Db%7D%2CremoveEventListener%3Afunction(a%2Cb)%7Bvar%20c%2Cd%2Ce%3Dthis.K%5Ba%5D%2Cf%3D%5B%5D%3Bfor(d%20in%20e)e.hasOwnProperty(d)%26%26e%5Bd%5D%3D%3D%3Db%26%26f.push(d)%3Bfor(c%3D0%3Bc%3Cf.length%3Bc%2B%2B)d%3Df%5Bc%5D%2Cdelete%20e%5Bd%5D%7D%2Cla%3Afunction()%7BC(this%2C1)%7D%2Coa%3Afunction(a)%7Bvar%20b%2Cc%3Btry%7Bb%3Da.x%7C%7Ca.clientX%7C%7Ca.offsetX%7C%7C0%2Cc%3Da.y%7C%7Ca.clientY%7C%7Ca.offsetY%7C%7C0%7Dcatch(d)%7Bc%3Db%3D0%7D0!%3Db%26%260!%3Dc%26%26this.addEntropy(%5Bb%2Cc%5D%2C2%2C%22mouse%22)%3BC(this%2C0)%7D%2Cqa%3Afunction(a)%7Ba%3D%0Aa.touches%5B0%5D%7C%7Ca.changedTouches%5B0%5D%3Bthis.addEntropy(%5Ba.pageX%7C%7Ca.clientX%2Ca.pageY%7C%7Ca.clientY%5D%2C1%2C%22touch%22)%3BC(this%2C0)%7D%2Cma%3Afunction()%7BC(this%2C2)%7D%2Cea%3Afunction(a)%7Ba%3Da.accelerationIncludingGravity.x%7C%7Ca.accelerationIncludingGravity.y%7C%7Ca.accelerationIncludingGravity.z%3Bif(window.orientation)%7Bvar%20b%3Dwindow.orientation%3B%22number%22%3D%3D%3Dtypeof%20b%26%26this.addEntropy(b%2C1%2C%22accelerometer%22)%7Da%26%26this.addEntropy(a%2C2%2C%22accelerometer%22)%3BC(this%2C0)%7D%7D%3B%0Afunction%20A(a%2Cb)%7Bvar%20c%2Cd%3Dsjcl.random.K%5Ba%5D%2Ce%3D%5B%5D%3Bfor(c%20in%20d)d.hasOwnProperty(c)%26%26e.push(d%5Bc%5D)%3Bfor(c%3D0%3Bc%3Ce.length%3Bc%2B%2B)e%5Bc%5D(b)%7Dfunction%20C(a%2Cb)%7B%22undefined%22!%3D%3Dtypeof%20window%26%26window.performance%26%26%22function%22%3D%3D%3Dtypeof%20window.performance.now%3Fa.addEntropy(window.performance.now()%2Cb%2C%22loadtime%22)%3Aa.addEntropy((new%20Date).valueOf()%2Cb%2C%22loadtime%22)%7Dfunction%20y(a)%7Ba.b%3Dz(a).concat(z(a))%3Ba.L%3Dnew%20sjcl.cipher.aes(a.b)%7Dfunction%20z(a)%7Bfor(var%20b%3D0%3B4%3Eb%26%26(a.h%5Bb%5D%3Da.h%5Bb%5D%2B1%7C0%2C!a.h%5Bb%5D)%3Bb%2B%2B)%3Breturn%20a.L.encrypt(a.h)%7D%0Afunction%20B(a%2Cb)%7Breturn%20function()%7Bb.apply(a%2Carguments)%7D%7Dsjcl.random%3Dnew%20sjcl.prng(6)%3B%0Aa%3Atry%7Bvar%20D%2CE%2CF%2CG%3Bif(G%3D%22undefined%22!%3D%3Dtypeof%20module%26%26module.exports)%7Bvar%20H%3Btry%7BH%3Drequire(%22crypto%22)%7Dcatch(a)%7BH%3Dnull%7DG%3DE%3DH%7Dif(G%26%26E.randomBytes)D%3DE.randomBytes(128)%2CD%3Dnew%20Uint32Array((new%20Uint8Array(D)).buffer)%2Csjcl.random.addEntropy(D%2C1024%2C%22crypto%5B\'randomBytes\'%5D%22)%3Belse%20if(%22undefined%22!%3D%3Dtypeof%20window%26%26%22undefined%22!%3D%3Dtypeof%20Uint32Array)%7BF%3Dnew%20Uint32Array(32)%3Bif(window.crypto%26%26window.crypto.getRandomValues)window.crypto.getRandomValues(F)%3Belse%20if(window.msCrypto%26%26window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F)%3B%0Aelse%20break%20a%3Bsjcl.random.addEntropy(F%2C1024%2C%22crypto%5B\'getRandomValues\'%5D%22)%7D%7Dcatch(a)%7B%22undefined%22!%3D%3Dtypeof%20window%26%26window.console%26%26(console.log(%22There%20was%20an%20error%20collecting%20entropy%20from%20the%20browser%3A%22)%2Cconsole.log(a))%7D%0Asjcl.json%3D%7Bdefaults%3A%7Bv%3A1%2Citer%3A1E4%2Cks%3A128%2Cts%3A64%2Cmode%3A%22ccm%22%2Cadata%3A%22%22%2Ccipher%3A%22aes%22%7D%2Cja%3Afunction(a%2Cb%2Cc%2Cd)%7Bc%3Dc%7C%7C%7B%7D%3Bd%3Dd%7C%7C%7B%7D%3Bvar%20e%3Dsjcl.json%2Cf%3De.g(%7Biv%3Asjcl.random.randomWords(4%2C0)%7D%2Ce.defaults)%2Cg%3Be.g(f%2Cc)%3Bc%3Df.adata%3B%22string%22%3D%3D%3Dtypeof%20f.salt%26%26(f.salt%3Dsjcl.codec.base64.toBits(f.salt))%3B%22string%22%3D%3D%3Dtypeof%20f.iv%26%26(f.iv%3Dsjcl.codec.base64.toBits(f.iv))%3Bif(!sjcl.mode%5Bf.mode%5D%7C%7C!sjcl.cipher%5Bf.cipher%5D%7C%7C%22string%22%3D%3D%3Dtypeof%20a%26%26100%3E%3Df.iter%7C%7C64!%3D%3Df.ts%26%2696!%3D%3Df.ts%26%26128!%3D%3Df.ts%7C%7C128!%3D%3Df.ks%26%26192!%3D%3Df.ks%26%260x100!%3D%3Df.ks%7C%7C2%3Ef.iv.length%7C%7C%0A4%3Cf.iv.length)throw%20new%20sjcl.exception.invalid(%22json%20encrypt%3A%20invalid%20parameters%22)%3B%22string%22%3D%3D%3Dtypeof%20a%3F(g%3Dsjcl.misc.cachedPbkdf2(a%2Cf)%2Ca%3Dg.key.slice(0%2Cf.ks%2F32)%2Cf.salt%3Dg.salt)%3Asjcl.ecc%26%26a%20instanceof%20sjcl.ecc.elGamal.publicKey%26%26(g%3Da.kem()%2Cf.kemtag%3Dg.tag%2Ca%3Dg.key.slice(0%2Cf.ks%2F32))%3B%22string%22%3D%3D%3Dtypeof%20b%26%26(b%3Dsjcl.codec.utf8String.toBits(b))%3B%22string%22%3D%3D%3Dtypeof%20c%26%26(f.adata%3Dc%3Dsjcl.codec.utf8String.toBits(c))%3Bg%3Dnew%20sjcl.cipher%5Bf.cipher%5D(a)%3Be.g(d%2Cf)%3Bd.key%3Da%3Bf.ct%3D%22ccm%22%3D%3D%3Df.mode%26%26sjcl.arrayBuffer%26%26sjcl.arrayBuffer.ccm%26%26%0Ab%20instanceof%20ArrayBuffer%3Fsjcl.arrayBuffer.ccm.encrypt(g%2Cb%2Cf.iv%2Cc%2Cf.ts)%3Asjcl.mode%5Bf.mode%5D.encrypt(g%2Cb%2Cf.iv%2Cc%2Cf.ts)%3Breturn%20f%7D%2Cencrypt%3Afunction(a%2Cb%2Cc%2Cd)%7Bvar%20e%3Dsjcl.json%2Cf%3De.ja.apply(e%2Carguments)%3Breturn%20e.encode(f)%7D%2Cia%3Afunction(a%2Cb%2Cc%2Cd)%7Bc%3Dc%7C%7C%7B%7D%3Bd%3Dd%7C%7C%7B%7D%3Bvar%20e%3Dsjcl.json%3Bb%3De.g(e.g(e.g(%7B%7D%2Ce.defaults)%2Cb)%2Cc%2C!0)%3Bvar%20f%2Cg%3Bf%3Db.adata%3B%22string%22%3D%3D%3Dtypeof%20b.salt%26%26(b.salt%3Dsjcl.codec.base64.toBits(b.salt))%3B%22string%22%3D%3D%3Dtypeof%20b.iv%26%26(b.iv%3Dsjcl.codec.base64.toBits(b.iv))%3Bif(!sjcl.mode%5Bb.mode%5D%7C%7C!sjcl.cipher%5Bb.cipher%5D%7C%7C%22string%22%3D%3D%3D%0Atypeof%20a%26%26100%3E%3Db.iter%7C%7C64!%3D%3Db.ts%26%2696!%3D%3Db.ts%26%26128!%3D%3Db.ts%7C%7C128!%3D%3Db.ks%26%26192!%3D%3Db.ks%26%260x100!%3D%3Db.ks%7C%7C!b.iv%7C%7C2%3Eb.iv.length%7C%7C4%3Cb.iv.length)throw%20new%20sjcl.exception.invalid(%22json%20decrypt%3A%20invalid%20parameters%22)%3B%22string%22%3D%3D%3Dtypeof%20a%3F(g%3Dsjcl.misc.cachedPbkdf2(a%2Cb)%2Ca%3Dg.key.slice(0%2Cb.ks%2F32)%2Cb.salt%3Dg.salt)%3Asjcl.ecc%26%26a%20instanceof%20sjcl.ecc.elGamal.secretKey%26%26(a%3Da.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0%2Cb.ks%2F32))%3B%22string%22%3D%3D%3Dtypeof%20f%26%26(f%3Dsjcl.codec.utf8String.toBits(f))%3Bg%3Dnew%20sjcl.cipher%5Bb.cipher%5D(a)%3Bf%3D%22ccm%22%3D%3D%3D%0Ab.mode%26%26sjcl.arrayBuffer%26%26sjcl.arrayBuffer.ccm%26%26b.ct%20instanceof%20ArrayBuffer%3Fsjcl.arrayBuffer.ccm.decrypt(g%2Cb.ct%2Cb.iv%2Cb.tag%2Cf%2Cb.ts)%3Asjcl.mode%5Bb.mode%5D.decrypt(g%2Cb.ct%2Cb.iv%2Cf%2Cb.ts)%3Be.g(d%2Cb)%3Bd.key%3Da%3Breturn%201%3D%3D%3Dc.raw%3Ff%3Asjcl.codec.utf8String.fromBits(f)%7D%2Cdecrypt%3Afunction(a%2Cb%2Cc%2Cd)%7Bvar%20e%3Dsjcl.json%3Breturn%20e.ia(a%2Ce.decode(b)%2Cc%2Cd)%7D%2Cencode%3Afunction(a)%7Bvar%20b%2Cc%3D%22%7B%22%2Cd%3D%22%22%3Bfor(b%20in%20a)if(a.hasOwnProperty(b))%7Bif(!b.match(%2F%5E%5Ba-z0-9%5D%2B%24%2Fi))throw%20new%20sjcl.exception.invalid(%22json%20encode%3A%20invalid%20property%20name%22)%3Bc%2B%3Dd%2B\'%22\'%2B%0Ab%2B\'%22%3A\'%3Bd%3D%22%2C%22%3Bswitch(typeof%20a%5Bb%5D)%7Bcase%20%22number%22%3Acase%20%22boolean%22%3Ac%2B%3Da%5Bb%5D%3Bbreak%3Bcase%20%22string%22%3Ac%2B%3D\'%22\'%2Bescape(a%5Bb%5D)%2B\'%22\'%3Bbreak%3Bcase%20%22object%22%3Ac%2B%3D\'%22\'%2Bsjcl.codec.base64.fromBits(a%5Bb%5D%2C0)%2B\'%22\'%3Bbreak%3Bdefault%3Athrow%20new%20sjcl.exception.bug(%22json%20encode%3A%20unsupported%20type%22)%3B%7D%7Dreturn%20c%2B%22%7D%22%7D%2Cdecode%3Afunction(a)%7Ba%3Da.replace(%2F%5Cs%2Fg%2C%22%22)%3Bif(!a.match(%2F%5E%5C%7B.*%5C%7D%24%2F))throw%20new%20sjcl.exception.invalid(%22json%20decode%3A%20this%20isn\'t%20json!%22)%3Ba%3Da.replace(%2F%5E%5C%7B%7C%5C%7D%24%2Fg%2C%22%22).split(%2F%2C%2F)%3Bvar%20b%3D%7B%7D%2Cc%2Cd%3Bfor(c%3D0%3Bc%3Ca.length%3Bc%2B%2B)%7Bif(!(d%3Da%5Bc%5D.match(%2F%5E%5Cs*(%3F%3A(%5B%22\'%5D%3F)(%5Ba-z%5D%5Ba-z0-9%5D*)%5C1)%5Cs*%3A%5Cs*(%3F%3A(-%3F%5Cd%2B)%7C%22(%5Ba-z0-9%2B%5C%2F%25*_.%40%3D%5C-%5D*)%22%7C(true%7Cfalse))%24%2Fi)))throw%20new%20sjcl.exception.invalid(%22json%20decode%3A%20this%20isn\'t%20json!%22)%3B%0Anull!%3Dd%5B3%5D%3Fb%5Bd%5B2%5D%5D%3DparseInt(d%5B3%5D%2C10)%3Anull!%3Dd%5B4%5D%3Fb%5Bd%5B2%5D%5D%3Dd%5B2%5D.match(%2F%5E(ct%7Cadata%7Csalt%7Civ)%24%2F)%3Fsjcl.codec.base64.toBits(d%5B4%5D)%3Aunescape(d%5B4%5D)%3Anull!%3Dd%5B5%5D%26%26(b%5Bd%5B2%5D%5D%3D%22true%22%3D%3D%3Dd%5B5%5D)%7Dreturn%20b%7D%2Cg%3Afunction(a%2Cb%2Cc)%7Bvoid%200%3D%3D%3Da%26%26(a%3D%7B%7D)%3Bif(void%200%3D%3D%3Db)return%20a%3Bfor(var%20d%20in%20b)if(b.hasOwnProperty(d))%7Bif(c%26%26void%200!%3D%3Da%5Bd%5D%26%26a%5Bd%5D!%3D%3Db%5Bd%5D)throw%20new%20sjcl.exception.invalid(%22required%20parameter%20overridden%22)%3Ba%5Bd%5D%3Db%5Bd%5D%7Dreturn%20a%7D%2Csa%3Afunction(a%2Cb)%7Bvar%20c%3D%7B%7D%2Cd%3Bfor(d%20in%20a)a.hasOwnProperty(d)%26%26a%5Bd%5D!%3D%3Db%5Bd%5D%26%26(c%5Bd%5D%3Da%5Bd%5D)%3Breturn%20c%7D%2Cra%3Afunction(a%2C%0Ab)%7Bvar%20c%3D%7B%7D%2Cd%3Bfor(d%3D0%3Bd%3Cb.length%3Bd%2B%2B)void%200!%3D%3Da%5Bb%5Bd%5D%5D%26%26(c%5Bb%5Bd%5D%5D%3Da%5Bb%5Bd%5D%5D)%3Breturn%20c%7D%7D%3Bsjcl.encrypt%3Dsjcl.json.encrypt%3Bsjcl.decrypt%3Dsjcl.json.decrypt%3Bsjcl.misc.pa%3D%7B%7D%3Bsjcl.misc.cachedPbkdf2%3Dfunction(a%2Cb)%7Bvar%20c%3Dsjcl.misc.pa%2Cd%3Bb%3Db%7C%7C%7B%7D%3Bd%3Db.iter%7C%7C1E3%3Bc%3Dc%5Ba%5D%3Dc%5Ba%5D%7C%7C%7B%7D%3Bd%3Dc%5Bd%5D%3Dc%5Bd%5D%7C%7C%7BfirstSalt%3Ab.salt%26%26b.salt.length%3Fb.salt.slice(0)%3Asjcl.random.randomWords(2%2C0)%7D%3Bc%3Dvoid%200%3D%3D%3Db.salt%3Fd.firstSalt%3Ab.salt%3Bd%5Bc%5D%3Dd%5Bc%5D%7C%7Csjcl.misc.pbkdf2(a%2Cc%2Cb.iter)%3Breturn%7Bkey%3Ad%5Bc%5D.slice(0)%2Csalt%3Ac.slice(0)%7D%7D%3B%0A%22undefined%22!%3D%3Dtypeof%20module%26%26module.exports%26%26(module.exports%3Dsjcl)%3B%22function%22%3D%3D%3Dtypeof%20define%26%26define(%5B%5D%2Cfunction()%7Breturn%20sjcl%7D)%3B%0A%3C%2Fscript%3E%0A%09%3Cscript%3E%0Avar%20encrypted%20%3D%20\'%7B%7Bencrypted-text%7D%7D\'%0Aif%20(encrypted.length%20%3D%3D%3D%200%20%7C%7C%20encrypted.substring(2%2C%2016)%20%3D%3D%3D%20\'encrypted-text\')%0A%09showError(form.submit%2C%20\'An%20error%20occured.\')%0A%09%3C%2Fscript%3E%0A%09%3Cscript%3E%0Avar%20form%20%3D%20%7B%0A%09password%3A%20document.getElementById(\'password\')%2C%0A%09submit%3A%20document.getElementById(\'submit\')%2C%0A%09message%3A%20document.getElementById(\'message\')%0A%7D%0Avar%20hint%20%3D%20document.getElementById(\'hint\')%0A%0Avar%20resetForm%20%3D%20function%20()%20%7B%0A%09form.password.classList.remove(\'error\')%0A%09form.submit.classList.remove(\'error\')%0A%09hint.style.display%20%3D%20\'none\'%0A%7D%0Avar%20showError%20%3D%20function%20(element%2C%20message)%20%7B%0A%09element.classList.add(\'error\')%0A%09hint.innerHTML%20%3D%20message%0A%09hint.style.display%20%3D%20\'block\'%0A%7D%0A%0Aform.submit.addEventListener(\'click\'%2C%20function%20()%20%7B%0A%09resetForm()%0A%0A%09if%20(form.password.value.length%20%3D%3D%3D%200)%0A%09%09return%20showError(form.password%2C%20\'Please%20enter%20a%20password.\')%0A%0A%09try%20%7B%20decrypted%20%3D%20sjcl.decrypt(form.password.value%2C%20encrypted)%20%7D%0A%09catch%20(error)%20%7B%20return%20showError(form.submit%2C%20\'The%20password%20seems%20to%20be%20wrong.\')%20%7D%0A%0A%09form.message.innerHTML%20%3D%20decrypted%0A%09form.password.value%20%3D%20\'\'%0A%7D%2C%20false)%0A%09%3C%2Fscript%3E%0A%3C%2Fbody%3E%0A%3C%2Fhtml%3E%0A'
if (bundle.length === 0 || bundle.substring(2, 16) === 'bundle-html')
	showError(form.submit, 'An error occured.')
bundle = decodeURIComponent(bundle)
	</script>
	<script>
var form = {
	message: document.getElementById('message'),
	password: document.getElementById('password'),
	submit: document.getElementById('submit')
}
var hint = document.getElementById('hint')

var resetForm = function () {
	form.message.classList.remove('error')
	form.password.classList.remove('error')
	form.submit.classList.remove('error')
	hint.style.display = 'none'
}
var showError = function (element, message) {
	element.classList.add('error')
	hint.innerHTML = message
	hint.style.display = 'block'
}

form.submit.addEventListener('click', function () {
	resetForm()

	if (form.message.value.length === 0)
		return showError(form.message, 'Please enter a message.')
	if (form.password.value.length === 0)
		return showError(form.password, 'Please enter a password.')

	try { encrypted = sjcl.encrypt(form.password.value, form.message.value) }
	catch (error) { return showError(form.submit, 'An error occured.') }

	html = bundle.replace('{{encrypted-text}}', encrypted)
	download(html, 'secret.html', 'text/html')
	form.password.value = ''
}, false)
	</script>
</body>
</html>
